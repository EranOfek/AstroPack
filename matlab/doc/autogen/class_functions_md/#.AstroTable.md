# Class: AstroTable



    
    AstroTable handle class  
    Package: @AstroTable  
    Description:  
    Tested : Matlab R2018a  
    Author : Eran O. Ofek (Mar 2021)  
    Dependencies: @convert, @celestial  
    Example :  
    Reliable: 2  
      
    See https://www.stsci.edu/instruments/wfpc2/Wfpc2_dhb/intro_ch23.html  
      
      
      

### Functions List

    AstroTable - Constrt an AstroTable object or transform AstCat/struct/ to AstroTable
    array2table - Convert catalog data in AstroTable to table format
    col2struct - return structure array with column names in field and index in values. Example: col2struct(A)
    colind2name - Return column names corresponding to column indices
    colname2ind - Convert column names to column indices
    colnameDict2ind - Given a list of column names, select the first that appear in Table
    compareColNames - Compare two ColNames's Package: @AstroTable (Static) Description: Given two cell array of strings compare their content. Return a vector of logical of length equal to the longer ColNames.
    csvWrite - who wrote this? missing help
    defaultColNames - create a default ColNames with N columns Package: @AstroTable (Static)
    deleteCatalog - delete the content of an AstroTable object Example: Result = deleteCatalog(Obj)
    deleteCol - Delete columns fron an AstroTable object.
    flipud - flip up-down all catalogs in AstroTable object (set IsSorted to false) Example: flipud(Obj)
    funUnary - Apply an unary function to columns of a catalog
    get.Catalog - getter for Image - get image from ImageData property
    get.ColNames - getter for ColNames
    get.ColUnits - getter for ColUnits
    getCol - Get a catalog columns by index or names
    getCol2struct - Get columns from AstroTable and return them in a structure array.
    getColDic - get a single Column data from a dictionary of column names
    help - show help in manuals.AstroTable
    insertCol - Insert columns to AstroTable object
    insertColumn - Insert a single column into a matrix, table, or a cell array Package: @AstroTable (Static) Description: Insert a single column into a matrix, table, or a cell array.
    insertLines - Insert rows from Matrix2 to Matrix1, including optional NaN filling and reordering. There are 2 related functions: insertLines and selectLines: selectLines is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true
    insertRows - Insert rows from Obj2 into Obj1 (e.g., Obj1(FlagInd,: ) = Obj2) There are 2 related functions: insertRows and selectRows: AstroTable/selectRows is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true
    isColIdentical - Check if ColNames in an AstroTable object is identical to another ColNames Package: @AstroTable Descriptio: For each element in a AstroTable object check if the ColNames property is equal to a reference ColNames.
    isColumn - Return true if a name is an existing column name in an AstroTable object Example: Result = isColumn(Obj,'RA')
    isemptyCatalog - Return true if Catalog data in AstroTable object is empty, otherwise false. example: Result = isemptyCatalog(Obj)
    max - Calculate the max value of all requested columns names/indices. Default is for all columns.
    merge - Merge table/matrices in multiple AstroTable elements
    min - Calculate the min value of all requested columns names/indices. Default is for all columns.
    plot - plot function for AstroTable objects
    plotFun - Operate a graphical function on AstroTable
    query - Query an AstroTable object
    queryRange - Query catalog by columns in range (without using eval). See also query
    replaceCol - replace (or insert) columns in AstroTable
    replaceColNames - Replace column names in AstroTable object
    searchSynonym - Find the first appearance of a synonym in a cell array.
    selectLines - Select rows from Matrix, including optional NaN filling and reordering. There are 2 related functions: insertLines and selectLines: selectLines is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true
    selectRows - Select rows from AstroTable object, including optional NaN filling and reordering. There are 2 related functions: insertRows and selectRows: AstroTable/selectRows is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true
    set.Catalog - setter for catalog - set also column names and units if table and available
    set.ColNames - setter for ColNames - input is either a cell or a string array if the catalog is in table format it will also set its Properties.VariableNames (but only if the size is consistent)
    set.ColUnits - setter for ColUnits - input is either a cell or a string array if the catalog is in table format it will also set its Properties.VariableUnits (but only if the size is consistent)
    set.SortByCol - Setter for SortByCol, also set IsSorted to false - sue sortrows to sort
    sizeCatalog - Return the number o rows and columns in all elements in an AstroTable object Example: [Nrow,Ncol] = sizeCatalog(Obj)
    sortrows - Sort AstroTable objects by some column names/indices
    table2array - Convert catalog data in AstroTable to array format
    unitTest - To do: -Add output checks for: -everything

### AstroTable

Constrt an AstroTable object or transform AstCat/struct/ to AstroTable


    
    Constrt an AstroTable object or transform AstCat/struct/ to AstroTable  
    Input  : - If empty then construct and empty AstroTable object.  
    If array/table, then construct an AstroTable object  
    with this array in the Catalog property.  
    If an AstCat/catCl object then convert it to  
    AstroTable object.  
    If file name or a cell array of file names, then  
    attempt read data from files. Cell array  
    contains a list of file names, while a single  
    file may contain wild cards or gegular  
    expressions.  
    * ...,Key,Val,...  
    'ColNames' - A cell array of column names.  
    If empty, try to use other inputs.  
    Default is {}.  
    'ColUnits' - A cell array of column units.  
    If empty, try to use other inputs.  
    Default is {}.  
    'UseRegExp' - Logical indicating if to use regexp  
    when using io.files.filelist.  
    Default is false.  
    'FileType' - File type from which to read data:  
    'fits' - FITS table. Default.  
    'hdf5' - HDF5 file (dataset is indicated by  
    HDU).  
    'ipac' | 'txt' | 'mat' | ...  
    'TableType' - FITS table type: ['auto'] | 'bintable' | 'table'  
    'HDU' - FITS HDU number or HDF5 dataset name.  
    'ArgsreadTable1' - A cell array of additional  
    arguments to pass to FITS.readTable1.  
    Default is {}.  
    'ConvertTable2array' - When eading a FITS table,  
    attempt to convert the table to an array (only of  
    all columns are of class double).  
    Default is true.  
    Output : - An AstroTable object.  
    Author : Eran Ofek (Mar 2021)  
    Example: AC = AstroTable  
    AC = AstroTable([2 2])  
    AC = AstroTable({rand(10,2),rand(10,2)})  
    AC = AstroTable({rand(10,2),rand(10,2)},'ColNames',{'a','b'});  
    AC = AstroTable({rand(10,2),rand(10,2)},'ConvertTable2array',false)  
    AC=AstroTable({array2table(rand(10,2))});  
    AC=AstroTable({rand(10,2)},'ColNames',{'RA','Dec'});  
    A = AstCat; A(1).Cat=rand(10,2);  
    A(2).Cat=rand(10,2); A(1).ColCell={'RA','Dec'};  
    A(1).ColUnits={'rad','rad'};  
    AC = AstroTable(A);  
    AC = AstroTable(A,'ColNames',{'RA','Dec'},'ColUnits',{'rad','rad'});  
    AC=AstroTable('asu.fit','HDU',2);  read from FITS table  
      


### array2table

Convert catalog data in AstroTable to table format


    
    Convert catalog data in AstroTable to table format  
      


### col2struct

return structure array with column names in field and index in values. Example: col2struct(A)


    
    return structure array with column names in field and index in values.  
    Example: col2struct(A)  
      


### colind2name

Return column names corresponding to column indices


    
    Return column names corresponding to column indices  
    Input  : - A single element AstroCatlog object  
    - A vector of column indices.  
    Output : - A cell array of column names corresponding to the  
    column indices.  
    Example: colind2name(AC,[2 1])  
      


### colname2ind

Convert column names to column indices


    
    Convert column names to column indices  
    Input  : - A single element AstroTable object.  
    - A column name, a cell array of column names or an  
    array of column indices.  
    If empty, then return all columns.  
    Default is empty.  
    - If the colun name is char or cell, and it doesn't  
    exist, this is the fill value for the column  
    index. If empty, will fail. Default is NaN.  
    Output : - A vector of column indices corresponding to the column names.  
    Author : Eran Ofek (Mar 2021)  
    Example: colname2ind(AC, {'Var1','aa'})  
    colname2ind(AC, [1 2])  
      


### colnameDict2ind

Given a list of column names, select the first that appear in Table


    
    Given a list of column names, select the first that appear in Table  
    Input  : - An AstroTable (single element)  
    - A cell array of column names  
    Output : - The selected column index.  
    - The selected column name.  
    - The index of the selected column in the input  
    ColNames.  
    Author : Eran Ofek (May 2021)  
    Example: AC = AstroTable({rand(10,2),rand(10,2)},'ColNames',{'a','b'});  
    [ColInd, ColName, IndOfSelectedName] = colnameDict2ind(AC(1),{'X','Y','a','Z'})  
      


### compareColNames

Compare two ColNames's Package: @AstroTable (Static) Description: Given two cell array of strings compare their content. Return a vector of logical of length equal to the longer ColNames.


    
    Compare two ColNames's  
    Package: @AstroTable (Static)  
    Description: Given two cell array of strings compare their  
    content. Return a vector of logical of length  
    equal to the longer ColNames.  
    Input  : - First ColNames  
    - Second ColNames  
    Output : - a vector of logical of length  
    equal to the longer ColNames. True if two elements  
    are identical.  
    Example: AstroTable.compareColNames({'a','b'},{'a','b'})  
      


### csvWrite

who wrote this? missing help


    
    who wrote this? missing help  


### defaultColNames

create a default ColNames with N columns Package: @AstroTable (Static)


    
    create a default ColNames with N columns  
    Package: @AstroTable (Static)  
    Input  : - Number of columns  
    Example: AstroTable.defaultColNames(5)  
      


### deleteCatalog

delete the content of an AstroTable object Example: Result = deleteCatalog(Obj)


    
    delete the content of an AstroTable object  
    Example: Result = deleteCatalog(Obj)  
      


### deleteCol

Delete columns fron an AstroTable object.


    
    Delete columns fron an AstroTable object.  
    Input  : - An AstroTable object.  
    - Column name, cell array of columns or column  
    indices to remove from Catalog.  
    Output : - An AstroTable object with the deleted columns.  
    Example: AC.Catalog=array2table(rand(10,3));  
    AC.ColNames={'RA','Dec','flux'}; AC.deleteCol('Dec')  
    AC.Catalog=(rand(10,3));  
    AC.ColNames={'RA','Dec','flux'}; AC.deleteCol({'RA','Dec'})  
      
      


### flipud

flip up-down all catalogs in AstroTable object (set IsSorted to false) Example: flipud(Obj)


    
    flip up-down all catalogs in AstroTable object (set IsSorted to false)  
    Example: flipud(Obj)  
      


### funUnary

Apply an unary function to columns of a catalog


    
    Apply an unary function to columns of a catalog  
    Input  : - An AstroTable object.  
    - Unary operator handle (e.g., @sin).  
    * ...,key,val,...  
    'OpArgs' - A cell array of additional arguments to pass to  
    the operator. Default is {}.  
    'Columns' - List of columns names or indices on which to apply  
    the operator. If empty, apply to all columns.  
    Default is empty.  
    'UpdateObj' - A logical indicating if to update the object (in  
    addition to returning the output).  
    Default is false.  
    Output : - The result (matrix or table).  
    Author : Eran Ofek (Mar 2021)  
    Example: AC=AstroTable; AC.Catalog = rand(100,3); AC.ColNames={'a','n','s'}; AC.funUnary(@sin)  
      


### get.Catalog

getter for Image - get image from ImageData property


    
    getter for Image - get image from ImageData property  


### get.ColNames

getter for ColNames


    
    getter for ColNames  
      


### get.ColUnits

getter for ColUnits


    
    getter for ColUnits  
      


### getCol

Get a catalog columns by index or names


    
    Get a catalog columns by index or names  
    Input  : - A single element AstroTable object.  
    - A vector of column indices, or a column name, or a  
    cell array of column names.  
    - If true will convert the output to table,  
    otherwise will attempt to convert to a matrix.  
    Default is false.  
    - If true than in addition to returning the sub  
    catalog, will store this sub catalog in the  
    AstroTable object.  
    Default is false.  
    * ...,key,val,...  
    ' UseDict' - unsupported  
    'SelectRows' - A vector of indices or logicals of  
    rows to select. If NaN, select all rows.  
    Default is NaN.  
    Output : - A matrix or a table containing the selected  
    columns.  
    - A cell array of units corresponding to the  
    requested columns.  
    Author : Eran Ofek (Mar 2021)  
    Example: AC.getCol({'Var1','Var3'},true)  
    AC.getCol([1 2])  
    AC.getCol({'Var1','Var3'},true,true)  
      


### getCol2struct

Get columns from AstroTable and return them in a structure array.


    
    Get columns from AstroTable and return them in a structure array.  
    Input  : - An AstroTable object.  
    - A cell array of column names.  
    * ...,key,val,...  
    'SelectRows'  - A vector of indices or logicals of  
    rows to select. If NaN, select all rows.  
    Default is NaN.  
    Output : - A structure array (element per AstroTable element)  
    with field for each selected column. Each field  
    contains thr column data.  
    Author : Eran Ofek (Sep 2021)  
    Example: AT = AstroTable({rand(1000,2)},'ColNames',{'a','b'});  
    S  = getCol2struct(AT, {'a'});  
      


### getColDic

get a single Column data from a dictionary of column names


    
    get a single Column data from a dictionary of column names  
    Input  : - A single-element AstroTable object.  
    - A cell array of columns. The first exitsing column will be selected.  
    Output : - A vector of the column content.  
    - Column units.  
    - Selected column index.  
    Author : Eran Ofek (Jul 2021)  
    Example: [Result, Units] = getColDic(MatchedCat,Args.CatColNamesX)  
      


### help

show help in manuals.AstroTable


    
    show help in manuals.AstroTable  
      


### insertCol

Insert columns to AstroTable object


    
    Insert columns to AstroTable object  
    Input  : - An AstroTable object  
    - Array, cell array, table, or another AstroTable  
    object to insert.  
    - Either number, or column name before which to insert  
    the new columns.  
    - Cell array of new column names. Default is {}.  
    If empty, then use default names.  
    - Cell array of new column units. Default is {}.  
    If empty, then use ''.  
    Output : - The AstroTable object with the new columns.  
    Example: A=AstroTable; A.Catalog=rand(10,3); A.ColNames={'a','b','c'}; insertCol(A,ones(10,2),'c')  
      


### insertColumn

Insert a single column into a matrix, table, or a cell array Package: @AstroTable (Static) Description: Insert a single column into a matrix, table, or a cell array.


    
    Insert a single column into a matrix, table, or a cell array  
    Package: @AstroTable (Static)  
    Description: Insert a single column into a matrix, table,  
    or a cell array.  
    Input  : - A matrix, cell array, or a table.  
    - A multiple column array, table, or cell array, in  
    which the number of rows is equal to the number of  
    rows in the first input argument.  
    The type must be equalt to the type of the first  
    input.  
    - A column index in which to insert the new column.  
    This is the index of the new column after  
    insertion. For example, 1 will insert the new  
    column as the first column. If Inf, will insert in  
    the last column position.  
    Output : - The new array.  
    Example: AstroTable.insertColumn({'a','b','c'},{'d','e'},2)  
    AstroTable.insertColumn(ones(5,3),zeros(5,2),2)  
    TT=array2table(zeros(5,2));  
    TT.Properties.VariableNames={'a','b'};  
    AstroTable.insertColumn(array2table(ones(5,3)),TT,2)  
      


### insertLines

Insert rows from Matrix2 to Matrix1, including optional NaN filling and reordering. There are 2 related functions: insertLines and selectLines: selectLines is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true


    
    Insert rows from Matrix2 to Matrix1, including optional NaN filling and reordering.  
    There are 2 related functions: insertLines and  
    selectLines:  
    selectLines is useful for operations like:  
    Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true  
    Result = NaN; Result(Ind,:) = Obj(FlagInd, :) insert NaN to Result when appear in FlagInd  
    insertLines is useful for operations like:  
    Obj1(FlagInd,:) = Obj2(FlagInd2,:)  keep original values in Obj1  
    Obj1 = NaN; Obj1(FlagInd,:) = Obj2(FlagInd2,:) insert NaN to Obj1 when appear in FlagInd  
    Input  : - A first matrix.  
    - A second matrix in which the number of coloumns is  
    equal or larger than the number of columns in the  
    first matrix.  
    - Indices in first matrix in which to put the lines  
    from the second matrix.  
    - Indices of lines in the second matrix to use.  
    * ...,key,val,...  
    'FillNaN' - A logical indicating if to fill  
    missing values with NaNs or to use orginal  
    values as appear in the 1st object.  
    Default is true.  
    Output : - A matrix which size is like that of the first  
    matrix, in which lines from the second matrix were  
    inserted.  
    The number of columns in the output matrix is  
    equal to the number of columns in the first  
    matrix.  
    Author : Eran Ofek (Sep 2021)  
    Example: Table = (1:1:5).'; Table = [Table, rand(size(Table))];  
    Table2 = (1:1:4).'; Table2 = [Table2, rand(size(Table2,1),2)];  
    Result = AstroTable.insertLines(Table, Table2(3:4,:), [1 2])  
    Result = AstroTable.insertLines(Table, Table2(3:4,:), [1 2],'FillNaN',false)  
      


### insertRows

Insert rows from Obj2 into Obj1 (e.g., Obj1(FlagInd,: ) = Obj2) There are 2 related functions: insertRows and selectRows: AstroTable/selectRows is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true


    
    Insert rows from Obj2 into Obj1 (e.g., Obj1(FlagInd,: ) = Obj2)  
    There are 2 related functions: insertRows and  
    selectRows:  
    AstroTable/selectRows is useful for operations like:  
    Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true  
    Result = NaN; Result(Ind,:) = Obj(FlagInd, :) insert NaN to Result when appear in FlagInd  
    AstroTable/insertRows is useful for operations like:  
    Obj1(FlagInd,:) = Obj2(FlagInd2,:)  
    Obj1 = NaN; Obj1(FlagInd,:) = Obj2(FlagInd2,:) insert NaN to Obj1 when appear in FlagInd  
    Input  : - An AstroTable object (multi elements supported).  
    - An AstroTable object (multi elements supported).  
    The insertion of columns is between corresponding  
    elements of the two AstroTable objects.  
    Either one to one, or one to many.  
    - Indices in first matrix in which to put the lines  
    from the second matrix.  
    Alternatively, this can be a cell array of vectors  
    in which each cell corresponds to an element in  
    the input object.  
    Or, this can be a structure array, in which each  
    element corresponds to an element in the input object.  
    The structure field containing the vector is  
    specified by the 'StructFieldName' key/val  
    argument.  
    - Indices of lines in the second matrix to use.  
    Alternatively, a structure, or cell.  
    * ...,key,val,...  
    'FillNaN' - A logical indicating if to fill  
    missing values with NaNs or to use orginal  
    values as appear in the 1st object.  
    Default is true.  
    'StructFieldName' - If the second input argument is  
    a structure, then this is the field name  
    that contains the vector of indices.  
    Default is 'Obj2_IndInObj1'.  
    Output : - An AstroTable/AstroCatalog object (same class as  
    first input object), which contain the resulted  
    object (new copy).  
    Author : Eran Ofek (Sep 2021)  
    Example: Table = (1:1:5).'; Table = [Table, rand(size(Table))];  
    AT = AstroTable({Table});  
    Table2 = (1:1:4).'; Table2 = [Table2, rand(size(Table2,1),2)];  
    AT2 = AstroTable({Table2});  
    Result = insertRows(AT, AT2, [1 2 3 4 5],[4 3 2 1 1]);  
    Result = insertRows(AT, AT2, [1 2 3 4 ],[4 3 2 1 ]);  
      


### isColIdentical

Check if ColNames in an AstroTable object is identical to another ColNames Package: @AstroTable Descriptio: For each element in a AstroTable object check if the ColNames property is equal to a reference ColNames.


    
    Check if ColNames in an AstroTable object is identical to another ColNames  
    Package: @AstroTable  
    Descriptio: For each element in a AstroTable object check if the  
    ColNames property is equal to a reference ColNames.  
    Input  : - An AstroTable object.  
    - A cell array of column names (i.e., a reference  
    ColNames).  
    Output : - A vector lf logical indicating if ColNames's are  
    identical  
    Example:  Ans=isColIdentical(C,C(4).ColNames)  
      


### isColumn

Return true if a name is an existing column name in an AstroTable object Example: Result = isColumn(Obj,'RA')


    
    Return true if a name is an existing column name in an AstroTable object  
    Example: Result = isColumn(Obj,'RA')  
      


### isemptyCatalog

Return true if Catalog data in AstroTable object is empty, otherwise false. example: Result = isemptyCatalog(Obj)


    
    Return true if Catalog data in AstroTable object is empty, otherwise false.  
    example: Result = isemptyCatalog(Obj)  
      


### max

Calculate the max value of all requested columns names/indices. Default is for all columns.


    
    Calculate the max value of all requested columns names/indices. Default is  
    for all columns.  
    Input  : - An AstroTable object.  
    - Column names or indices. If empty, then use all.  
    Default is empty.  
    Output : - An array of maximum values. Line per object  
    element, column per Catalog column.  
    Example: AC=AstroTable('asu.fit','HDU',2);  
    AC.max  
    AC.max({'mag1','mag2'})  
    max([AC;AC],{'mag1','mag2'})  
      


### merge

Merge table/matrices in multiple AstroTable elements


    
    Merge table/matrices in multiple AstroTable elements  
    Input  : - An AstroTable object.  
    - Columns to merge. Either column names or column  
    indices. If empty, merge all columns.  
    * ...,key,val,...  
    'IsTable' - Attempt to merge the catalogs as  
    tables. Default is false.  
    Output : - A new AstroTable object containing the merged  
    catalog.  
    Author : Eran Ofek (Mar 2021)  
    Example: AC = AstroTable; AC(1).Catalog=rand(10,3);  
    AC(1).ColNames={'a','b','c'}; AC(2).Catalog=rand(10,2);  
    AC(2).ColNames={'a','c'};  
    NAC=merge(AC,{'a','c'})  
      
    AC = AstroTable; AC(1).Catalog=rand(10,3);  
    AC(1).ColNames={'a','b','c'}; AC(2).Catalog=rand(10,3); AC(2).ColNames={'a','b','c'};  
    NAC=merge(AC)  
      


### min

Calculate the min value of all requested columns names/indices. Default is for all columns.


    
    Calculate the min value of all requested columns names/indices. Default is  
    for all columns.  
    Input  : - An AstroTable object.  
    - Column names or indices. If empty, then use all.  
    Default is empty.  
    Output : - An array of minimum values. Line per object  
    element, column per Catalog column.  
    Example: AC=AstroTable('asu.fit','HDU',2);  
    AC.min  
    AC.min({'mag1','mag2'})  
    min([AC;AC],{'mag1','mag2'})  
      


### plot

plot function for AstroTable objects


    
    plot function for AstroTable objects  
    Input  : - An AstroTable object (multiple elements is supported).  
    If more then one element, then will plot all and  
    return the hold state to its original state.  
    - A vector of [X, Y] colum indices, or a cell array  
    of X, Y column names.  
    * Additional arguments to pass to the plot function  
    e.g., 'o','Color',[1 1 0],'MarkerFaceColor',[1 1 0].  
    Output : - An handle for the last plot.  
    Author : Eran Ofek (Apr 2021)  
    Example: AT = AstroTable; AT.Catalog=[(1:1:10).',(1:1:10).', rand(10,1)]  
    AT(2).Catalog = [(1:1:10).', (10:-1:1).', rand(10,1)];  
    AT(1).ColNames={'X','Y','Flux'};  
    AT(2).ColNames={'X','Y','Flux'};  
    AT.plot({'X','Y'},'o','MarkerFaceColor','r');  
      


### plotFun

Operate a graphical function on AstroTable


    
    Operate a graphical function on AstroTable  
    Input  : - An AstroTable object. If multiple elements, then  
    perform the plot for each element, and hold on.  
    The hold state will return to its original state.  
    - A plot handle function. e.g., @plot.  
    Default is @plot.  
    - A single column name, a cell array of column  
    names, or a vector of column indices.  
    Default is [1 2].  
    * Additional arguments to pass to thre plot  
    function.  
    Output : - The plot handle. If multiple elemnts, then only  
    the handle of the lastes plot will be returned.  
    Author : Eran Ofek (Apr 2021)  
    Example: AT = AstroTable; AT.Catalog=rand(10,4);  
    AT.ColNames={'a','b','c','d'};  
    AT.plotFun(@plot,{'a','c'},'o')  
    AT.plotFun(@plot,[1 2],'o','Color','b')  
    AT.plotFun(@hist,{'c'})  
    AT.plotFun(@hist,'d')  
    AT.plotFun(@plot3,[1 2 4],'o','Color','b')  
      


### query

Query an AstroTable object


    
    Query an AstroTable object  
    Input  : - An AstroTable object.  
    - A query string with operators on column names  
    (e.g., 'mag1>8 & mag2<10'),  
    * ...,key,val,...  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    Output : - An AstroTable object with the selected lines.  
    Author : Eran Ofek (Feb 2016)  
    Example: AC=AstroTable('asu.fit','HDU',2);  
    BC=query(AC,'mag1>8 & mag2<10');  
    query(AC,'mag1>8 & mag2<10','CreateNewObj',false);  modifies AC  
    AC=AstroTable('asu.fit','HDU',2);  
    BC=query([AC;AC],'mag1>8 & mag2<10');  
    AC=array2table(AC)  
    BC=query(AC,'mag1>8 & mag2<10');  
      


### queryRange

Query catalog by columns in range (without using eval). See also query


    
    Query catalog by columns in range (without using eval).  
    See also query  
    Input  : - An AstroTable object.  
    * ...,key,val,... of column name and column range.  
    Column name may be a cell array of column names  
    from which the first to appear will be selected  
    (dictionary), or a single column name.  
    Column range may be a range of one or two numbers,  
    and only values within the range (>=, <=) will be  
    selected.  
    Output : - An AstroTable object, with the selected rows.  
    If nargout>0, then a new copy is created, if  
    nargout=0, the original object is modified.  
    - A vector of logical of the selected rows, for the  
    last element of the AstroTable input.  
    Author : Eran Ofek (Jun 2021)  
    Example: AT=AstroTable({rand(100,2)},'ColNames',{'x','y'});  
    [Result, Flag] = queryRange(AT, 'x',[0.2 0.3],'y',[0.0 0.5])  
    [Result, Flag] = queryRange(AT, {'x_win','x'},[0.2 0.3],'y',[0.0 1])  
      
    CreateNewObj treatment  


### replaceCol

replace (or insert) columns in AstroTable


    
    replace (or insert) columns in AstroTable  
    Input  : - An AstroTable object.  
    - Data of columns to replace. This may be a matrix,  
    cell array, a table or another AstroTable  
    object. However, the data types should be  
    consistent.  
    If AstroTable then numver of elements should be  
    1 or equal to the number of elements in the first  
    input.  
    - Column names to replace insert.  
    - Position for new insertion. Default is Inf.  
    BUGS   : The function doesn't handle a mix of insert/replace.  
    Example: AC = AstroTable;  
    AC(1).Catalog = rand(100,3);  
    AC(1).ColNames={'a','b','c'};  
    AC=AC.replaceCol(nan(100,2),{'a','b'});  
      


### replaceColNames

Replace column names in AstroTable object


    
    Replace column names in AstroTable object  
    Input  : - An AstroTable object.  
    - A cell array of column names in the existing input  
    AstroTable object, or a vector of indices.  
    - A cell array of new names to replace the old  
    column names.  
    Output : - An AstroTable object with the updated column  
    names.  
    Example: AC.replaceColNames([1 2],{'RA','Dec'})  
      


### searchSynonym

Find the first appearance of a synonym in a cell array.


    
    Find the first appearance of a synonym in a cell array.  
    Input  : - A cell array of names.  
    - A cell array of synonyms.  
    * ...,key,val,...  
    'CaseSens' - Case sensetive search. Default is  
    false.  
    Output : - The found name as appear in the Cell of names.  
    - The index of the name in the cell of names.  
    - The index of the name as appear in the cell of  
    synonyms.  
    Example: [Name, IndInCell, IndInSynonym] = AstroTable.searchSynonym({'Number','ra','dec','Flux','Color'},{'ALPHA_J2000','RAJ2000','RA','ALPHA'});  
      


### selectLines

Select rows from Matrix, including optional NaN filling and reordering. There are 2 related functions: insertLines and selectLines: selectLines is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true


    
    Select rows from Matrix, including optional NaN filling and reordering.  
    There are 2 related functions: insertLines and  
    selectLines:  
    selectLines is useful for operations like:  
    Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true  
    Result = NaN; Result(Ind,:) = Obj(FlagInd, :) insert NaN to Result when appear in FlagInd  
    insertLines is useful for operations like:  
    Obj1(FlagInd,:) = Obj2(FlagInd2,:)  
    Obj1 = NaN; Obj1(FlagInd,:) = Obj2(FlagInd2,:) insert NaN to Obj1 when appear in FlagInd  
    Input  : - A matrix.  
    - A vector of logicals or aindices.  
    In the case that this is a vector of logicals, no  
    NaNs are allowed, and the function will return the  
    lines with logical true.  
    In case this is a vector of indices (NaNs are  
    allowed), the corresponding lines will be  
    returned.  
    * ...,key,val,...  
    'IgnoreNaN' - A logical indicating if to ignore  
    the NaNs in the vector of indices.  
    Default is false.  
    Output : - Matrix with selected (and optionaly filled with  
    NaNs) lines.  
    Author : Eran Ofek (Sep 2021)  
    Example : Table = (1:1:5).'; Table = [Table, rand(size(Table))];  
    Result = AstroTable.selectLines(Table, [1;2])  
    Result = AstroTable.selectLines(Table, [2 3 2])  
    Result = AstroTable.selectLines(Table, [true, true, false, true, false])  
    Result = AstroTable.selectLines(Table, [2 3 2 NaN],'IgnoreNaN',true)  
    Result = AstroTable.selectLines(Table, [2 3 NaN 2 NaN],'IgnoreNaN',false)  
      


### selectRows

Select rows from AstroTable object, including optional NaN filling and reordering. There are 2 related functions: insertRows and selectRows: AstroTable/selectRows is useful for operations like: Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true


    
    Select rows from AstroTable object, including optional NaN filling and reordering.  
    There are 2 related functions: insertRows and  
    selectRows:  
    AstroTable/selectRows is useful for operations like:  
    Result = Obj(FlagInd, :) w/o NaN in FlagInd or IgnoreNaN=true  
    Result = NaN; Result(Ind,:) = Obj(FlagInd, :) insert NaN to Result when appear in FlagInd  
    AstroTable/insertRows is useful for operations like:  
    Obj1(FlagInd,:) = Obj2(FlagInd2,:)  
    Obj1 = NaN; Obj1(FlagInd,:) = Obj2(FlagInd2,:) insert NaN to Obj1 when appear in FlagInd  
    Input  : - An AstroTable object (multi elements supported).  
    - A vector of logicals or indices.  
    In the case that this is a vector of logicals, no  
    NaNs are allowed, and the function will return the  
    lines with logical true.  
    In case this is a vector of indices (NaNs are  
    allowed), the corresponding lines will be  
    returned.  
    Alternatively, this can be a cell array of vectors  
    in which each cell corresponds to an element in  
    the input object.  
    Or, this can be a structure array, in which each  
    element corresponds to an element in the input object.  
    The structure field containing the vector is  
    specified by the 'StructFieldName' key/val  
    argument.  
    * ...,key,val,...  
    'IgnoreNaN' - A logical indicating if to ignore  
    the NaNs in the vector of indices.  
    Default is false.  
    'StructFieldName' - If the second input argument is  
    a structure, then this is the field name  
    that contains the vector of indices.  
    Default is 'Obj2_IndInObj1'.  
    'CreateNewObj' - true|false. Create new object.  
    Default is true.  
    Output : - An AstroTable object with the selected (and optionaly filled with  
    NaNs) lines.  
    Author : Eran Ofek (Sep 2021)  
    Example: Table = (1:1:5).'; Table = [Table, rand(size(Table))];  
    AT = AstroTable({Table});  
    Result = selectRows(AT, [1;2])  
    Result = selectRows(AT, [2 3 2])  
    Result = selectRows(AT, [true, true, false, true, false])  
    Result = selectRows(AT, [2 3 2 NaN],'IgnoreNaN',true)  
    Result = selectRows(AT, [2 3 NaN 2 NaN],'IgnoreNaN',false)  
      


### set.Catalog

setter for catalog - set also column names and units if table and available


    
    setter for catalog - set also column names and units if table  
    and available  
      


### set.ColNames

setter for ColNames - input is either a cell or a string array if the catalog is in table format it will also set its Properties.VariableNames (but only if the size is consistent)


    
    setter for ColNames - input is either a cell or a string array  
    if the catalog is in table format it will also set its  
    Properties.VariableNames (but only if the size is consistent)  


### set.ColUnits

setter for ColUnits - input is either a cell or a string array if the catalog is in table format it will also set its Properties.VariableUnits (but only if the size is consistent)


    
    setter for ColUnits - input is either a cell or a string array  
    if the catalog is in table format it will also set its  
    Properties.VariableUnits (but only if the size is consistent)  


### set.SortByCol

Setter for SortByCol, also set IsSorted to false - sue sortrows to sort


    
    Setter for SortByCol, also set IsSorted to false - sue sortrows to sort  
      


### sizeCatalog

Return the number o rows and columns in all elements in an AstroTable object Example: [Nrow,Ncol] = sizeCatalog(Obj)


    
    Return the number o rows and columns in all elements in an AstroTable object  
    Example: [Nrow,Ncol] = sizeCatalog(Obj)  
      


### sortrows

Sort AstroTable objects by some column names/indices


    
    Sort AstroTable objects by some column names/indices  
    Input  : - An AstroTable object (multiple elements is possible).  
    - A column/s names or indices by which to sort the  
    catalogs. If empty, will attempt to use the  
    SortByCol property. Default is empty.  
    Output : - An object in which the catalogs are sorted.  
    Author : Eran Ofek (Mar 2021)  
    Example: AC=AstroTable; AC.Catalog = rand(100,3); AC=sortrows(AC,2);  
      


### table2array

Convert catalog data in AstroTable to array format


    
    Convert catalog data in AstroTable to array format  
      


### unitTest

To do: -Add output checks for: -everything


    
    To do:  
    -Add output checks for:  
    -everything  
      


