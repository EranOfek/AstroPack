# Class: FITS



    
    FITS  
      
      

### Functions List

    FITS - FITS object constructor
    delete_keys - Delete a lits of keywords from a list of FITS headers Package: @FITS (Static) Description: Delete a list of header keywords from a list of FITS images.
    get_keys - Get keywords value from a single FITS header Package: @FITS (Static function) Description: Get the values of specific keywords from a single FITS file header. Use only for existing keywords.
    mget_keys - Get header keywords value from multiple FITS Package: @FITS (Static) Description: Get the values of specific keywords from a list of FITS files header.
    numHDU - return the number of HDUs in a FITS file
    numHDU1 - return the number of HDUs in a single FITS file A static function of FITS class
    read - Read all FITS file to a FITS object
    read1 - Read a single image from a FITS file A static function of FITS class
    read2cube - Read a list of FITS images into a cube (multiple file names or multiple HDUs) Static function
    read2sim - Description: Read FITS images into SIM object. Can read N-dimensional images. Can also read multi extension files.
    readHeader - Read an header into a three column cell array
    readHeader1 - Read a single header from a FITS file (Static) A static function of FITS class
    readTable - Read binary or ascii multiple FITS table into a FITS object. Package: @FITS (Static) Description: Read binary or ascii FITS tables into a a FITS object.
    readTable1 - Read binary or ascii single FITS table Package: @FITS (Static) Description: Read binary or ascii FITS tables into a table.
    unitTest - unitTest for the FITS class
    write - Write or append an image into FITS file. Static function The image may have N-dimensions. Append will write multi extension FITS image.
    write_keys - Insert or update FITS header keywords Package: @FITS (Static) Description: Insert new, or update existing FITS header keywords in a list of FITS images.

### FITS

FITS object constructor


    
    FITS object constructor  
    Input  : - A cell array of file names, a file name or a file name with wild cards.  
    - A vector of HDU numbers with size 1, or equal in  
    size to the file list.  
    Output : - A FITS object with the File and HDU properties  
    populated.  
      


### delete_keys

Delete a lits of keywords from a list of FITS headers Package: @FITS (Static) Description: Delete a list of header keywords from a list of FITS images.


    
    Delete a lits of keywords from a list of FITS headers  
    Package: @FITS (Static)  
    Description: Delete a list of header keywords from a list of  
    FITS images.  
    Input  : - List of FITS image names to read. See io.files.filelist.m for  
    options.  
    - Cell array of keyword names to delete.  
    Output : null  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jun 2014  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example: FITS.delete_keys('A.fits',{'PTFPID','OBJECT'})  
    Reliable: 2  
      
      


### get_keys

Get keywords value from a single FITS header Package: @FITS (Static function) Description: Get the values of specific keywords from a single FITS file header. Use only for existing keywords.


    
    Get keywords value from a single FITS header  
    Package: @FITS (Static function)  
    Description: Get the values of specific keywords from a single  
    FITS file header. Use only for existing keywords.  
    Input  : - FITS image name.  
    - Cell array of keys to retrieve from the image header.  
    - HDU number. Default is 1.  
    If NaN, then set to 1.  
    - Check if the keyword value is char and try to convert to  
    a number {false|true}. Default is false.  
    Output : - Cell array of keyword values.  
    - Cell array of keyword comments.  
    - Structure containing the keyword names (as fields)  
    and their values.  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jul 2014  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example: [KeysVal,KeysComment,Struct]=FITS.get_keys('A.fits',{'NAXIS1','NAXIS2'});  
    Reliable: 2  
      
      


### mget_keys

Get header keywords value from multiple FITS Package: @FITS (Static) Description: Get the values of specific keywords from a list of FITS files header.


    
    Get header keywords value from multiple FITS  
    Package: @FITS (Static)  
    Description: Get the values of specific keywords from a list of  
    FITS files header.  
    Input  : - List of FITS image names. See io.files.filelist.m for options.  
    - Cell array of keys to retrieve from the image header.  
    - HDU number. Default is 1.  
    - Check if the keyword value is char and try to convert to  
    a number {false|true}. Default is false.  
    Output : - Cell array (per image) of cell array of keyword values.  
    - Cell array (per image) of cell array of keyword comments.  
    - Structure array (element per image) containing the keyword  
    names (as fields) and their values.  
    - Cell array containing the list of images.  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jul 2014  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example:  
    [KeysVal,KeysComment,Struct,List]=FITS.mget_keys('PTF_201202*.fits',{'NAXIS1','NAXIS2'});  
    Reliable: 2  
      
      


### numHDU

return the number of HDUs in a FITS file


    
    return the number of HDUs in a FITS file  
    Input  : - A FITS object with the file name populated (or the  
    file name can be provided in the 2nd argument)  
    - Optional single file name (in this case the 1st  
    arg must contain a single element).  
    Output : - An array of number of HDUs in each file.  
    NaN if file name is empty.  
    Author : Eran Ofek  
    Example: Nhdu=numHDU(Obj,FileName)  
      


### numHDU1

return the number of HDUs in a single FITS file A static function of FITS class


    
    return the number of HDUs in a single FITS file  
    A static function of FITS class  
    Input  : - FITS file name.  
    Output : - Number of HDUs in FITS file  
    Author : Eran Ofek  
    Example: Nhdu=FITS.numHDU1(FileName)  
      


### read

Read all FITS file to a FITS object


    
    Read all FITS file to a FITS object  
    Input  : - A FITS object  
    - An optional file name (to read a single file)  
    - An optional HDU (to read a single file)  
    * ...,key,val,...  
    'ReadHead' - Read the header. Default is true.  
    'CCDSEC' - [xmin xmax ymin ymax] to read.  
    If empty read all. Default is empty.  
    Output : - A FITS object with the Data andHeader fields  
    populated.  
    Author : Eran Ofek (Mar 2021)  
    Example: Obj=read(Obj,1,'CCDSEC',[1 10 1 10])  
      


### read1

Read a single image from a FITS file A static function of FITS class


    
    Read a single image from a FITS file  
    A static function of FITS class  
    Input  : - FITS file name.  
    - HDU number. default is 1.  
    * ...,key,val,...  
    'CCDSEC' - [xmin xmax ymin ymax] of image to read.  
    If empty read entire image.  
    Default is empty.  
    Output : - Image.  
    - A 3 column cell array of header entries.  
    Author : Eran Ofek  
    Example: [Image,HeadCell,Nhdu]=FITS.read1(FileName,HDUnum)  
      


### read2cube

Read a list of FITS images into a cube (multiple file names or multiple HDUs) Static function


    
    Read a list of FITS images into a cube (multiple file names or multiple HDUs)  
    Static function  
    Input  : - An image name with wild cards or a cell array of  
    image names.  
    - A scalar or a vector of HDU numbers.  
    * ...,key,val,...  
    'CCDSEC' - [xmin xmax ymin ymax] of image to read.  
    If empty read entire image.  
    Default is empty.  
    Output : - A cube of images. Image index is in 3rd dimension.  
    Author : Eran Ofek  
    Example: [Cube]=read2cube(List,HDUnum);  
      


### read2sim

Description: Read FITS images into SIM object. Can read N-dimensional images. Can also read multi extension files.


    
    Description: Read FITS images into SIM object.  
    Can read N-dimensional images.  
    Can also read multi extension files.  
    Input  : - List of images to read. See Util.files.create_list.m for  
    details.  
    * Arbitrary number of pairs of ...,key,val,...  
    input arguments. Available keywords are:  
    'HDUnum' - HDU to read. If multiple numbers are  
    given then will attempt to read multiple  
    HDU each one into different SIM  
    element.  
    If empty, then will attemp to read all  
    extensions.  
    Default is 1.  
    'CCDSEC' - A four column matrix of CCDSEC  
    [xmin xmax ymin ymax] to read.  
    Either line per image or a single line.  
    'Sim'    - An existing SIM into to write the FITS  
    images. If empty, then create a new  
    SIM object. Default is empty.  
    'ExecField'- SIM field into which to write the  
    FITS images. Default is 'Im'.  
    'ReadHead'- Read header into SIM. Default is true.  
    'HDUnum' - Index of HDU. Default is 1.  
    'PopWCS' - Populate WCS. Default is true.  
    Output: - A SIM object with the FITS images.  
    Example: S=FITS.read2sim('Image*.fits');  
    S=FITS.read2sim('Image6[15-28].fits');  
    S=FITS.read2sim('@list');  
    S=FITS.read2sim('Image,fits','CCDSEC',[1 10 1 100]);  
    Reliable: 2  
      


### readHeader

Read an header into a three column cell array


    
    Read an header into a three column cell array  
    Input  : - A FITS object.  
    - An optional single FITS file name.  
    If empty/not provided use FITS.File property.  
    - HDU number. If empty/not provided then  
    If fits file name (2nd arg) is given than default  
    is 1, else take from FITS.HDU property.  
    Output : - A FITS object with the Header field populated.  
    - A three column cell array with the entire header.  
    If more than one file was read, than this is the  
    last header read.  
    - Number of HDUs in file. If more than one file was read, than this is  
    corresponds to the last file read.  
    Example:  
    FITS.readHeader('PTF_201211224002_i_p_scie_t093619_u014676207_f02_p100037_c02.fits')  
      


### readHeader1

Read a single header from a FITS file (Static) A static function of FITS class


    
    Read a single header from a FITS file (Static)  
    A static function of FITS class  
    Input  : - FITS file name  
    - HDU number. Default is 1  
    Output : - A 3 column cell array of header entries  
    [Key, Value, Comment]  
    - Number of HDUs in FITS file  
    Author : Eran Ofek  
    Example: [HeadCell,Nhdu] = FITS.readHeader1(FileName,HDUnum)  
      


### readTable

Read binary or ascii multiple FITS table into a FITS object. Package: @FITS (Static) Description: Read binary or ascii FITS tables into a a FITS object.


    
    Read binary or ascii multiple FITS table into a FITS object.  
    Package: @FITS (Static)  
    Description: Read binary or ascii FITS tables into a a FITS object.  
    Input  : - A FITS object.  
    - A single FITS tables anem to read. If not provided  
    then will use the file name in the object.  
    - HDU number. If empty use the one in the object.  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'TableType'- FITS table type {'auto'|'bintable'|'table'}.  
    Default is 'auto'.  
    'auto' will attempt to read the table type  
    from the 'XTENSION' header keyword.  
    'HDUnum'   - HDU number in which the FITS table header is.  
    Default is 2.  
    'ModColName' - If the program failed because some columns  
    have name starting with numbers or invalid signs  
    set this to true (default is false).  
    This will modify the column names.  
    'OutTable' - Type of table output:  
    'table' - Default.  
    'astcat' - AstCat object.  
    'astcat_t' - AstCat object in which  
    the data is stored as a table.  
    'XTENkey'  - Header keyword from which to read the table type.  
    Default is 'XTENSION'.  
    'StartRow' - First row to read from FITS table. Default is [].  
    If empty, then read the entire table.  
    'NRows'    - Number of rows to read from FITS table.  
    Default is []. If empty, then read the entire  
    table.  
    'OutClass' - A function to use in order to force all the  
    columns to be of the same class (e.g., @single).  
    Default is @double. If empty, then will keep  
    the original class. This option shoyld be used  
    if you want to read the data into a matrix.  
    'NullVal'  - If the column is of numeric type will attempt  
    to replace the FITS null value with this value.  
    Default is NaN.  
    'BreakRepCol'- {true|false}. If true and FITS table columns  
    are repeating then will change column information  
    according to the matrix column count.  
    Default is true.  
    Output : - A FITS object populated with tables and headers.  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jan 2015  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example: Obj.readTable('asu.fit');  
    Reliable: 2  
      
      


### readTable1

Read binary or ascii single FITS table Package: @FITS (Static) Description: Read binary or ascii FITS tables into a table.


    
    Read binary or ascii single FITS table  
    Package: @FITS (Static)  
    Description: Read binary or ascii FITS tables into a table.  
    Input  : - A FITS tables to read.  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'TableType'- FITS table type {'auto'|'bintable'|'table'}.  
    Default is 'auto'.  
    'auto' will attempt to read the table type  
    from the 'XTENSION' header keyword.  
    'HDUnum'   - HDU number in which the FITS table header is.  
    Default is 2.  
    'ModColName' - If the program failed because some columns  
    have name starting with numbers or invalid signs  
    set this to true (default is false).  
    This will modify the column names.  
    'OutTable' - Type of table output:  
    'table' - Default  
    'XTENkey'  - Header keyword from which to read the table type.  
    Default is 'XTENSION'.  
    'StartRow' - First row to read from FITS table. Default is [].  
    If empty, then read the entire table.  
    'NRows'    - Number of rows to read from FITS table.  
    Default is []. If empty, then read the entire  
    table.  
    'OutClass' - A function to use in order to force all the  
    columns to be of the same class (e.g., @single).  
    Default is @double. If empty, then will keep  
    the original class. This option shoyld be used  
    if you want to read the data into a matrix.  
    'NullVal'  - If the column is of numeric type will attempt  
    to replace the FITS null value with this value.  
    Default is NaN.  
    'BreakRepCol'- {true|false}. If true and FITS table columns  
    are repeating then will change column information  
    according to the matrix column count.  
    Default is true.  
    Output : - A table containing the FITS table content.  
    - The FITS file header.  
    - A structure array of additional columns  
    information, like format.  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jan 2015  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example: [Out,Head,Col]=FITS.readTable1('asu.fit');  
    Reliable: 2  
      
      
      


### unitTest

unitTest for the FITS class


    
    unitTest for the FITS class  


### write

Write or append an image into FITS file. Static function The image may have N-dimensions. Append will write multi extension FITS image.


    
    Write or append an image into FITS file.  
    Static function  
    The image may have N-dimensions.  
    Append will write multi extension FITS image.  
    Input  : - Array to save as FITS image.  
    - FITS file name to save.  
    * Arbitrary number of ...,key,val,... pairs.  
    Following keywords are available:  
    'Header' - Cell array of {key,val,comment} header  
    or an HEAD object to write into the  
    FITS file.  
    'DataType' - Data type - default is 'single'  
    precision.  
    'Append' - Append image as a multi extension to an  
    existing FITS file. Default is false.  
    'OverWrite'- Overwrite an existing image. Default  
    is false.  
    'WriteTime'- Add creation time to image header.  
    Default is false.  
    Example: Flag=FITS.write(rand(100,100),'Try.fits');  
    Flag=FITS.write(rand(10,10,3),'Try.fits');  
      
      


### write_keys

Insert or update FITS header keywords Package: @FITS (Static) Description: Insert new, or update existing FITS header keywords in a list of FITS images.


    
    Insert or update FITS header keywords  
    Package: @FITS (Static)  
    Description: Insert new, or update existing FITS header keywords in  
    a list of FITS images.  
    Input  : - List of FITS image names to edit. See io.files.filelist.m for  
    options.  
    - A cell array of two or three columns of key/cal/comments to  
    add to FITS header.  
    Output : null  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jun 2014  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example: FITS.write_keys('A.fits',{'try','A','comm';'try2',6,'what'});  
    Reliable: 2  
      
      


