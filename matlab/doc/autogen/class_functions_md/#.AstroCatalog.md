# Class: AstroCatalog



    
    AstroCatalog class - A container of AstroTable with coordinates  
    See https://www.stsci.edu/instruments/wfpc2/Wfpc2_dhb/intro_ch23.html  
      
      
      
      

### Functions List

    AstroCatalog - Constructor for AstroCatalog For parameters input see: AstroTable Example: AC=AstroCatalog({'asu.fit','asu.fit'},'HDU',2)
    boundingCircle - Fit a bounding circle position and radius to a catalog
    convertCooUnits - convert all spherical coordinates Units for multiple element object
    cropXY - crop AstroCatalog object by X/Y coordinates. Including updateing the X/Y coordinates. The function may operate on multiple AstroCatalog and/or multiple sections. For example, it can produce multiple crops of a single
    getColCooForCooType - Get the X/RA and Y/Dec column indices for a specific CooType
    getCommomCooType - get common CooType for two AstroCatalog objects.
    getCooType - Return the Coordinate type of an AstroCatalog
    getLonLat - Get Lon/Lat columns from AstroCatalog.
    getRADecPM - get RA/Dec/PM/Plx/RV from astrometric catalog
    getXY - Get X/Y columns from AstroCatalog.
    help - show mlx help file for AstroCatalog
    insertFlagColFromMask - Insert/replace FLAGS column in AstroCatalog as populated from a MaskImage object. Description: Given an AstroCatalog and a MaskImage objects, for each source in the AstroCatalog, search the FLAGS in the MaskImage (bitwise or/and) within a user provided radius (default is 3 pix). These FLAGS will be
    isCooPix - Check if X/Y (pixel) coordinates exist in an AstroCatalog
    isCooSphere - Check if RA/Dec (units) coordinates exist in an AstroCatalog
    perfTest - perfTest for the AstroCatalog class
    plotMapFun - A general map (RA/Dec) plotting function for AstroCatalog object
    plotSources - Plot sources by their X/Y position, where the symbol size corresponds to magnitude.
    sphere_dist - Calculate the spherical distance and PA between Lon,Lat in Astrocatalog and a Lon, Lat in array.
    unitTest - unitTest for the AstroCatalog class

### AstroCatalog

Constructor for AstroCatalog For parameters input see: AstroTable Example: AC=AstroCatalog({'asu.fit','asu.fit'},'HDU',2)


    
    Constructor for AstroCatalog  
    For parameters input see: AstroTable  
    Example: AC=AstroCatalog({'asu.fit','asu.fit'},'HDU',2)  
      
    construct AstroTable  


### boundingCircle

Fit a bounding circle position and radius to a catalog


    
    Fit a bounding circle position and radius to a catalog  
    Input  : - An AstroCatalog object (multi elements supported).  
    All elements must have the same CooType.  
    * ...,key,val,...  
    'OutUnits' - Output units. Default is 'deg'.  
    'CooType' - Coordinate type {'sphere'|'pix'}.  
    If empty, use the AstroCatalog CooType.  
    Default is empty.  
    Output : - The best fit circle X/Long  
    - The best fit circle Y/Lat  
    - The best fit circle radius  
    Author : Eran Ofek (Apr 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [Result] = imProc.match.coneSearch(AC, [1 1], 'Radius',3600.*10)  
    [CircleX, CircleY, CircleRadius] = boundingCircle(Result);  
      


### convertCooUnits

convert all spherical coordinates Units for multiple element object


    
    convert all spherical coordinates Units for multiple element object  
    Input  : - An AstroCatalog object  
    - Units of RA/Dec to convert into.  
    - Cell array of dictionary for RA column names.  
    Default is AstroCatalog.DefNamesRA.  
    - Cell array of dictionary for Dec column names.  
    Default is AstroCatalog.DefNamesDec.  
    Output : - An AstroCatalog object with the updated units.  
    Author : Eran Ofek (Aug 2021)  
    Example: AC=AstroCatalog({'asu.fit','asu.fit'},'HDU',2)  
    AC.convertCooUnits('deg')  
    Obj.convertCooUnits('deg')  
      


### cropXY

crop AstroCatalog object by X/Y coordinates. Including updateing the X/Y coordinates. The function may operate on multiple AstroCatalog and/or multiple sections. For example, it can produce multiple crops of a single


    
    crop AstroCatalog object by X/Y coordinates.  
    Including updateing the X/Y coordinates.  
    The function may operate on multiple AstroCatalog  
    and/or multiple sections.  
    For example, it can produce multiple crops of a single  
    catalog.  
    Input  : - An AstroCatalog object.  
    - CCDSEC [Xmin, Xmax, Ymin, Ymax]  
    * ...,key,val,...  
    'ColX' - Name, or cell array (from which to select  
    first that appears) of X column name on  
    which to operate the cropping.  
    Default is Obj.DefNamesX  
    'ColY' - Name, or cell array (from which to select  
    first that appears) of Y column name on  
    which to operate the cropping.  
    Default is Obj.DefNamesY  
    'AddX' - A cell array of additional columns which  
    contains X coordinates and requires updating  
    after cropping. Default is {}.  
    'AddY' - Like 'AddX', but for Y coordinates.  
    'UpdateXY' - A logical indicating if to update the  
    X/Y  coordinates, such that the new  
    coordinates will refer to the new cropped  
    image. Default is true.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    Output : - An AstroCatalog object with the updated catalog.  
    Author : Eran Ofek (Jul 2021)  
    Example: AC = AstroCatalog({rand(100,3).*100}, 'ColNames',{'XWIN','YWIN','Flux'});  
    Result = cropXY(AC, [1 50 1 50])  
    Result = cropXY(AC, [81 100 41 70],'AddX',{'Flux'})  
    Result = cropXY(AC, [81 100 41 70; 1 50 1 50]);  multiple crops of a single catalog  
      


### getColCooForCooType

Get the X/RA and Y/Dec column indices for a specific CooType


    
    Get the X/RA and Y/Dec column indices for a specific CooType  
    Input  : - An AstroCatalog object  
    - CooType: 'sphere' | 'pix'  
    Output : - An array of X/RA column indices (one per element).  
    - An array of Y/Dec column indices (one per element).  
    Author : Eran Ofek (Aug 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [ColX, ColY] = getColCooForCooType(AC, 'sphere')  
      


### getCommomCooType

get common CooType for two AstroCatalog objects.


    
    get common CooType for two AstroCatalog objects.  
    Input  : - The first AstroCatalog object (multi elements  
    supported).  
    - The second AstroCatalog object (multi elements  
    supported).  
    Output : - A vector of logical (length identical to the  
    longest of Obj1/Obj2) containing true if both  
    objects has sphereical CooType.  
    - A vector of logical (length identical to the  
    longest of Obj1/Obj2) containing true if both  
    objects has pix CooType.  
    - A cell array of chars, indicating 'sphere' (if  
    both objects have spherical coordinates),  
    otherwise 'pix' (if both have pix coordinates),  
    and empty otherwise.  
    Author : Eran Ofek (Aug 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [IsSphereBoth, IsPixBoth, CooType] = getCommomCooType(AC, AC)  
      


### getCooType

Return the Coordinate type of an AstroCatalog


    
    Return the Coordinate type of an AstroCatalog  
    Input  : - An AstroCatalog object  
    Output : - A cell array of CooType. If 'sphere' exist, then  
    it will be declared as 'sphere'.  
    - A cell array of units.  
    - An array of X/RA colum indices (one per element).  
    - An array of Y/Dec colum indices (one per element).  
    Author : Eran Ofek (Aug 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [CooType, Units, ColX, ColY] = getCooType(AC);  
      


### getLonLat

Get Lon/Lat columns from AstroCatalog.


    
    Get Lon/Lat columns from AstroCatalog.  
    Input - A single element AstroCatalog object.  
    - Units of output Lon/Lat columns.  
    Default is 'deg'.  
    * ...,key,val,...  
    'ColLon' - A cell array of Lon column names. Will  
    select the first exitsing column name.  
    Default is Obj(1).DefNamesRA.  
    'ColLat' - A cell array of Lat column names. Will  
    select the first exitsing column name.  
    Default is Obj(1).DefNamesDec.  
    Output : * If two argument are requested then these are RA and Dec.  
    If a single argument is  
    requested then this is a two column matrix of  
    [RA, Dec].  
    Author : Eran Ofek (May 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [Lon,Lat] = getLonLat(AC);  
    [Lon,Lat] = getLonLat(AC,'rad');  
      


### getRADecPM

get RA/Dec/PM/Plx/RV from astrometric catalog


    
    get RA/Dec/PM/Plx/RV from astrometric catalog  
    Input  : - A single element AstroCatalog object.  
    * ...,key,val,...  
    'OutCooUnits' - Output coo units. Default is 'rad'  
    'OutPMUnits' - Output PM units. Default is 'mas/yr'  
    'OutPlxUnits' - Output Plx units. Default is 'mas'  
    'OutRVUnits' - Output RV units. Default is 'km/s'  
    Output : - RA  
    - Dec  
    - PM RA  
    - PM Dec  
    - Plx  
    - RV  
    Author : Eran Ofek (May 2021)  
    Example: C=catsHTM.cone_search('GAIADR2',1,1,100,'OutType','astrocatalog');  
    [RA, Dec, PM_RA, PM_Dec, Plx, RV] = getRADecPM(C)  
      


### getXY

Get X/Y columns from AstroCatalog.


    
    Get X/Y columns from AstroCatalog.  
    Input - A single element AstroCatalog object.  
    * ...,key,val,...  
    'ColX' - A cell array of X column names. Will  
    select the first exitsing column name.  
    Default is Obj(1).DefNamesX.  
    'ColY' - A cell array of Y column names. Will  
    select the first exitsing column name.  
    Default is Obj(1).DefNamesY.  
    Output : * If two argument are requested then these are X and Y.  
    If a single argument is  
    requested then this is a two column matrix of  
    [X, Y].  
    Author : Eran Ofek (May 2021)  
    Example:  
    AC=AstroCatalog({rand(100,2)},'ColNames',{'XWIN_IMAGE','YWIN_IMAGE'});  
    [X,Y] = getXY(AC);  
      


### help

show mlx help file for AstroCatalog


    
    show mlx help file for AstroCatalog  


### insertFlagColFromMask

Insert/replace FLAGS column in AstroCatalog as populated from a MaskImage object. Description: Given an AstroCatalog and a MaskImage objects, for each source in the AstroCatalog, search the FLAGS in the MaskImage (bitwise or/and) within a user provided radius (default is 3 pix). These FLAGS will be


    
    Insert/replace FLAGS column in AstroCatalog as populated from a MaskImage object.  
    Description: Given an AstroCatalog and a MaskImage objects,  
    for each source in the AstroCatalog, search the FLAGS  
    in the MaskImage (bitwise or/and) within a user  
    provided radius (default is 3 pix). These FLAGS will be  
    inserted (or replaced) in the AstroCatalog object as a  
    new column.  
    Note that by default, unless the Catalog is a table  
    type, the FLAGS typw will be casted to have the same  
    type as the Catalog data.  
    Input  : - A single-element AstroCatalog object.  
    - A single-element MaskImage object.  
    * ...,key,val,...  
    'CastToType' - A logical indicating if to cast the  
    type of the inserted Flags column to be the  
    same as the AstroCatalog object Catalog  
    data (if Catalog is of table type, then  
    this is ignored). Default is true.  
    'ColX' - A cell array of X column names. Will  
    select the first exitsing column name.  
    Default is AstroCatalog.DefNamesX.  
    'ColY' - - A cell array of Y column names. Will  
    select the first exitsing column name.  
    Default is AstroCatalog.DefNamesY.  
    'FlagColName' - The flags column name.  
    Default is 'FLAGS'.  
    'ColPos' - If Flags column doesn't exist, then  
    this is the position in which to insert the  
    new column. Default is Inf.  
    'CreateNewObj' - - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    'BitWiseOperator' - Bit-wise Operator: ['or'] | 'and'  
    'HalfSize' - Cutout half size (actual size will be  
    1+2*HalfSize. Default is 3.  
    'CutAlgo' - Algorithm: ['mex'] | 'wmat'.  
    'IsCircle' - If true then will pad each cutout  
    with NaN outside the HalfSize radius.  
    Default is false.  
    'DataProp' - Data property from which to extract  
    the cutouts. Default is 'Image'.  
    Example: AC = AstroCatalog({rand(100,2).*1024}, 'ColNames',{'X','Y'});  
    MI = MaskImage({uint32(ones(1024,1024).*5)});  
    insertFlagColFromMask(AC, MI)  
      


### isCooPix

Check if X/Y (pixel) coordinates exist in an AstroCatalog


    
    Check if X/Y (pixel) coordinates exist in an AstroCatalog  
    Input  : - An AstroCatalog object.  
    - Cell array of dictionary for X column names.  
    Default is AstroCatalog.DefNamesX.  
    - Cell array of dictionary for Y column names.  
    Default is AstroCatalog.DefNamesY.  
    Output : - An array of logical indicating if each one of the  
    Astrocatalog elements contains an X/Y columns.  
    - A cell array of units.  
    - An array of X colum indices (one per element).  
    - An array of Y colum indices (one per element).  
    Author : Eran Ofek (Aug 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [Result, Units, ColX, ColY] = isCooPix(AC);  
      


### isCooSphere

Check if RA/Dec (units) coordinates exist in an AstroCatalog


    
    Check if RA/Dec (units) coordinates exist in an AstroCatalog  
    Input  : - An AstroCatalog object.  
    - Cell array of dictionary for RA column names.  
    Default is AstroCatalog.DefNamesRA.  
    - Cell array of dictionary for Dec column names.  
    Default is AstroCatalog.DefNamesDec.  
    Output : - An array of logical indicating if each one of the  
    Astrocatalog elements contains an RA/Dec columns.  
    - A cell array of units per AstroCatalog element.  
    - An array of RA colum indices (one per element).  
    - An array of Dec colum indices (one per element).  
    Author : Eran Ofek (Aug 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [Result, Units, ColRA, ColDec] = isCooSphere(AC);  
      


### perfTest

perfTest for the AstroCatalog class


    
    perfTest for the AstroCatalog class  


### plotMapFun

A general map (RA/Dec) plotting function for AstroCatalog object


    
    A general map (RA/Dec) plotting function for AstroCatalog object  
    Input  : - A single element AstroCatalog object.  
    - Map projection. See axesm for options.  
    Default is 'aitoff'.  
    - Plot function handle. e.g., @plotm.  
    Default is @plotm.  
    - Cell array of additional columns (to Dec, RA) to pass to the  
    plot function (e.g., in the case of @scatterm).  
    Default is {}.  
    * Additional arguments to pass to the plot function.  
    Output : -  
    Author : Eran Ofek (Apr 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    AC.plotMapFun('aitoff',@plotm,{},'.','MarkerSize',1)  
      
    AC.plotMapFun('aitoff',@scatterm,{'mag1','sep1'},'.','MarkerSize',1)  
      


### plotSources

Plot sources by their X/Y position, where the symbol size corresponds to magnitude.


    
    Plot sources by their X/Y position, where the symbol size corresponds to magnitude.  
    Input  : - A single element AstroCatalog object.  
    * ...,key,val,...  
    'ColX' - A cell array of X column names dictionary.  
    Default is AstroCatalog.DefNamesX.  
    'ColY' - A cell array of Y column names dictionary.  
    Default is AstroCatalog.DefNamesY.  
    'ColMag' - A cell array of Mag column names dictionary.  
    Default is AstroCatalog.DefNamesMag.  
    'MinMaxSize' - [Min Max] of symbol size area.  
    Scaled from magnitude.  
    Default is [3 30].  
    'InvertScaling' - Invert magnitude to size scaling  
    (brighter is bigger). Default is true.  
    'Color' - Symbol color. Default is 'k'.  
    Example: AT = AstroCatalog({rand(100,3)},'ColNames',{'X','Y','Mag'});  
    AT.plotSources  
    CC=catsHTM.cone_search('GAIAEDR3', '01:21:39.560','+15:12:25.70',600,'OutType','AstroCatalog');  
    CC.plotSources('ColX',{'RA'},'ColY',{'Dec'})  
      


### sphere_dist

Calculate the spherical distance and PA between Lon,Lat in Astrocatalog and a Lon, Lat in array.


    
    Calculate the spherical distance and PA between Lon,Lat in  
    Astrocatalog and a Lon, Lat in array.  
    Input  : - A single-element AstroCatlog Object.  
    - Lon (scalar, or column vector with the same length  
    as the AstroCatalog catalog, or a row vector of  
    arbitrary length).  
    - Lat  
    - Lon/Lat units. Default is 'deg'.  
    - Output units of Dist and PA. Default is 'deg'.  
    Output : - Angular distance.  
    - Position angle, as calculated by celestial_sphere.  
    Author : Eran Ofek (Jul 2021)  
    Example: AC=AstroCatalog({'asu.fit'},'HDU',2);  
    [Dist, PA] = sphere_dist(AC,1,1);  
      


### unitTest

unitTest for the AstroCatalog class


    
    unitTest for the AstroCatalog class  


