# Class: AstroSpec



    
      
      
### AstroSpec

constructor for AstroSpec


    
    constructor for AstroSpec  
    Input  : - An AstroSpec, Matrix, table, or cell array of  
    matrix/tables.  
    - A cell array of column names.  
    - A cell array of unit names.  
    Output : - An AstroSpec object  
    Exanple: AS = AstroSpec(rand(100,2))  
      
### applyExtinctionZ

Calculate extinction to observed wavelngth vector in various redshifts.


    
    Calculate extinction to observed wavelngth vector in various redshifts.  
    Input  : - A vector of wavelength [Ang] in the observed  
    frame.  
    - A vector redshifts in which to apply extinction.  
    - A vector of E_{B-V} to apply in each redshift.  
    Use negative E_{B-V} to apply the inverse  
    operator.  
    - A vector of R_V to use in each redshift.  
    Default is 3.08.  
    Output : - A vector of extinction factors, corresponding to  
    the observed wavelength.  
    Author : Eran Ofek (Aug 2021)  
    Example: Factor = AstroSpec.applyExtinctionZ([5000 5010]', [0.5, 0], [0.2, 0.05], [2, 3.08])  
      
### blackBody

Create an AstroSpec object with black body spectra Return specific (per Ang) luminosity or emittence.


    
    Create an AstroSpec object with black body spectra  
    Return specific (per Ang) luminosity or emittence.  
    Input  : - A vector of wavelengths, or an AstroSPec object  
    from which the wavelength vector will be taken.  
    - A vector of temperature.  
    * ...,key,val,...  
    'Radius' - Scalar or vector of BB radii for conversion  
    to luminosity. If empty,  
    then return the spectra in units of  
    emittemce from a cm^2/s/A on the BB.  
    'RadiusUnits' - Radius units. Default is 'cm'.  
    'Dist' - Scalar of vector of distances. If empty,  
    then return the spectra in units of  
    emittemce from a cm^2/s/A on the BB.  
    'DistUnits' - Distance units. Default is 'pc'.  
    'SpecType' - Spectrum type:  
    'P'  - planck formula, default.  
    'RJ' - Rayleigh-Jeans approximation  
    'W'  - Wein spectrum.  
    Output : - An AstroSPec array, with element per temperature.  
    Author : Eran Ofek (Aug 2021)  
    Example: Result = AstroSpec.blackBody((4000:10:9000)', [5000; 6000])  
      
### filterFun

Apply a 1-D function (filter) on the Flux field in AstroSpec object. The function do not check if the wavelength is equally spaced. The function operates on the Flux, FluxErr, and Back fields.


    
    Apply a 1-D function (filter) on the Flux field in AstroSpec  
    object. The function do not check if the wavelength is  
    equally spaced.  
    The function operates on the Flux, FluxErr, and Back fields.  
    Input  : - An AstroSpec object.  
    - A function handle. E.g., @medfilt1, @hampel,  
    @sgolayfilt,...  
    * Additional arguments to pass to the specific  
    function.  
    Output : - If no output argument is requested, then will modify the input  
    AstroSpec object. Otherwise, will create a new  
    copy of the object.  
    The oupt contains the filtered spectra.  
    Author : Eran Ofek (Aug 2021)  
    Example: AS=AstroSpec.blackBody((4000:10:9000)', [5000; 6000]);  
    AS.filterFun(@medfilt1,10)  
      
### fitSpec

UNDER CONSTRUCTION


    
    UNDER CONSTRUCTION  
      
    Example: Spec = AstroSpec.synspecGAIA('Temp',[5750],'Grav',[4.5]);  
    BB = AstroSpec.blackBody(Spec.Wave, 5750);  
    Result = fitSpec(Spec, BB)  
      
### funFlux

Apply a function to the Flux, FluxErr, Back columns.


    
    Apply a function to the Flux, FluxErr, Back columns.  
    Input  : - An AstroSpec object.  
    - A function handle to apply.  
    * ...,key,val,...  
    'FunArgs' - A cell array of additional arguments to pass to  
    the function.  
    'DataProp' - A cell array of data properties on  
    which to apply the function.  
    Default is {'Flux', 'FluxErr', 'Back'}.  
    'CreateNewObj' -  [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec objec after aplying the function.  
    Author : Eran Ofek (Aug 2021)  
    Example:  Spec = AstroSpec.synspecGAIA('Temp',[5750 5500 5550],'Grav',[4.5]);  
    Res  = funFlux(Spec, @log10);  
      
### get.Back

getter for Back


    
    getter for Back  
      
### get.Flux

getter for Flux


    
    getter for Flux  
      
### get.FluxErr

getter for FluxErr


    
    getter for FluxErr  
      
### get.FluxUnits

getter for FluxUnits


    
    getter for FluxUnits  
      
### get.Mask

getter for Mask data


    
    getter for Mask data  
      
### get.Wave

getter for Wave


    
    getter for Wave  
      
### get.WaveUnits

getter for WaveUnits


    
    getter for WaveUnits  
      
### interp1

Interpolate the elements of AstroSpec into a new wavelength grid. The Mask will be interpolated using nearest interpolation. This function works only if the Data is convertable to a numeric matrix.


    
    Interpolate the elements of AstroSpec into a new wavelength grid.  
    The Mask will be interpolated using nearest  
    interpolation. This function works only if the Data is  
    convertable to a numeric matrix.  
    Input  : - An AstroSpec object.  
    - A vector of new wavelngth grid on which to  
    interpolate the AstroSpec object.  
    Alternatively, a AstroSpec object with wavelength.  
    * ...,key,val,...  
    'Method' - Interpolation method. See interp1 for  
    options. Default is 'linear'.  
    'ExtraArgs' - A cell array of additional arguments  
    to pass to interp1. Default is {}.  
    'RemoveNan' - A logical indicating of to remove  
    NaNs. Default is false.  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec object with the interpolated spectra.  
    Author : Eran Ofek (Aug 2021)  
    Example: S = AstroSpec({rand(100,3)});  
    S.sort;  
    S.interp1([0:0.1:1]);  
      
### interpAndKeepOverlap

Given two AstroSpec objects, interpolate the first into the wavelength grid defined by the second and keep only the overlaping points.


    
    Given two AstroSpec objects, interpolate the first into the  
    wavelength grid defined by the second and keep only the  
    overlaping points.  
    Input  : - The first AstroSpec object (multi elements  
    supported).  
    - The second AstroSpec object (multi elements  
    supported).  
    'Method' - Interpolation method. See interp1 for  
    options. Default is 'linear'.  
    'ExtraArgs' - A cell array of additional arguments  
    to pass to interp1. Default is {}.  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec object with the interpolated spectra.  
    Author : Eran Ofek (Aug 2021)  
    Example: S1 = AstroSpec({rand(100,3)});  
    S1.sort  
    S2 = AstroSpec({rand(100,3).*0.5});  
    S2.sort  
    [New1, New2] = interpAndKeepOverlap(S1, S2);  
      
### interpLogSpace

Interpolate an AstroSpec object into a logarithmic wavelength grid.


    
    Interpolate an AstroSpec object into a logarithmic wavelength grid.  
    Input  : - An AstroSpec object.  
    * ...,key,val,...  
    'Res' - Resolution (Dlambda/lambda) to use fot the  
    log-spacing. If empty, estimate using  
    wave-diff. Default is [].  
    'Method' - Interpolation method. See interp1 for  
    options. Default is 'linear'.  
    'ExtraArgs' - A cell array of additional arguments  
    to pass to interp1. Default is {}.  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec object with logarithmic spaced  
    wavelength grid.  
    Output : - An AstroSpec object with the interpolated spectra.  
    Author : Eran Ofek (Aug 2021)  
    Example: Spec = AstroSpec.synspecGAIA('Temp',[5750],'Grav',[4.5]);  
    Result = interpLogSpace(Spec);  
      
### interpOverNan

Interpolate AstroSpec object over NaNs.


    
    Interpolate AstroSpec object over NaNs.  
    Input  : - An AstroSpec object.  
    * ...,key,val,...  
    'Method' - Interpolation method. See interp1 for  
    options. Default is 'linear'.  
    'ExtraArgs' - A cell array of additional arguments  
    to pass to interp1. Default is {}.  
    'DataProp' - Data property in which to look for  
    NaNs. Default is 'Flux'.  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec object with the interpolated spectra.  
    (NaNs are interpolated over).  
    Author : Eran Ofek (Aug 2021)  
    Example: S = AstroSpec({rand(100,3)});  
    S.sort;  
    S.Flux(2:5) = NaN;  
    R = S.interpOverNan;  
      
### interpOverRanges

Interpolate AstroSpec object over some ranges Useful for interpolation over ranges containing spectral lines.


    
    Interpolate AstroSpec object over some ranges  
    Useful for interpolation over ranges containing  
    spectral lines.  
    Input  : - An AstroSpec object.  
    - A two column matrix of [Min Max] ranges.  
    Each line is a wavelength range, and data points  
    within (<>) this range will be interpolated.  
    * ...,key,val,...  
    'Method' - Interpolation method. See interp1 for  
    options. Default is 'linear'.  
    'ExtraArgs' - A cell array of additional arguments  
    to pass to interp1. Default is {}.  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec object with the interpolated spectra.  
    Author : Eran Ofek (Aug 2021)  
    Example: S = AstroSpec({rand(100,3)});  
    S.sort;  
    Ranges = [0.2 0.5; 0.6 0.9];  
    R = S.interpOverRanges(Ranges);  
      
### length

Return length of each spectrum in AstroSpec object


    
    Return length of each spectrum in AstroSpec object  
    Input  : - An AstroSpec object.  
    Output : - A vector of lengths of each spectrum.  
    Author : Eran Ofek (Aug 2021)  
    Example: AS = AstroSpec({rand(100,3)});  
    AS.length  
      
### plot

Plot all the spectra in an AstroSpec object


    
    Plot all the spectra in an AstroSpec object  
    Input  : - An AstroSpec object (multi elements supported)  
    * Additional input arguments to pass to the plot  
    command.  
    Output : - AN handle for the last plot.  
    Author : Eran Ofek (Aug 2021)  
    Example: Result = AstroSpec.blackBody((4000:10:9000)', [5000; 6000]);  
    Result.plot  
      
### read2FilterMatrix

Convet a filter name/AstFilter to cell of transmissions


    
    Convet a filter name/AstFilter to cell of transmissions  
    Input  : - A cell of family names, a family name, a matrix or  
    an AstFilter object.  
    - A filter name or a cell of names.  
    Output : - A cell array of filter transmissions.  
    - A cell array of filter names.  
    Author : Eran Ofek (Aug 2021)  
    Example: [FilterCell, Name] = AstroSpec.read2FilterMatrix(Family, Name)  
      
### redshift

Apply redshift to a spectrum Divide wave by (1+z) and multiply flux by (1+z) Correct also FluxErr and Back


    
    Apply redshift to a spectrum  
    Divide wave by (1+z) and multiply flux by (1+z)  
    Correct also FluxErr and Back  
    Input  : - An AstroSpec object.  
    - Output redshift. Use 0, in order to convert the  
    spectrum to rest frame. Default is 0.  
    - Input redshift. If empty, then will attempt to  
    read it from the Z property. Default is [].  
    * ...,key,val,...  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    'CorrectFluxErr' - Default is true.  
    'CorrectBack'    - Default is true.  
    Output : - An updated AstroSpec object.  
    If output is not requested, then by default will  
    change the input object (see CreateNewObj arg).  
    Author : Eran Ofek (Aug 2021)  
    Example: S = AstroSpec({rand(100,3)});  
    NS = AS.copyObject;  
    NS.redshift=0.5;  
    NS.Z=0.5;  
    NS.redshift(0)  
      
### selectWave

Select lines from AstroSpec (don't generate a new copy)


    
    Select lines from AstroSpec (don't generate a new copy)  
    Input  : - An AstroSpec object  
    - A vector of logical flags or indices of lines to  
    select.  
    Output : - The original AstroSpec with the removed lines.  
    Author : Eran Ofek (Aug 2021)  
    Example: AS = AstroSpec({rand(100,3)});  
    AS = selectWave(AS, [1 2 3]);  
      
### set.Back

setter for Back


    
    setter for Back  
      
### set.Flux

setter for Flux


    
    setter for Flux  
      
### set.FluxErr

setter for FluxErr


    
    setter for FluxErr  
      
### set.FluxUnits

setter for FluxUnits


    
    setter for FluxUnits  
      
### set.Mask

setter for Mask data


    
    setter for Mask data  
      
### set.Wave

setter for Wave


    
    setter for Wave  
      
### set.WaveUnits

setter for WaveUnits


    
    setter for WaveUnits  
      
### sort

Sort elements of AstroSpec object by wavelength


    
    Sort elements of AstroSpec object by wavelength  
    Input  : - An AstroSpec object.  
    * ...,key,val,...  
    'CreateNewObj' - [], true, false.  
    If true, create new deep copy  
    If false, return pointer to object  
    If [] and Nargout0 then do not create new copy.  
    Otherwise, create new copy. Default is [].  
    Output : - An AstroSpec object with the elements sorted by  
    wavelength.  
    Author : Eran Ofek (Aug 2021)  
    Example: S = AstroSpec({rand(100,3)});  
    S.sort;  
      
### synphot

Synthetic photometry on an AstroSpec object spectra


    
    Synthetic photometry on an AstroSpec object spectra  
    Input  : - An AstroSpec object (multi elements supported)  
    - A cell of filter family names, an AstFilter  
    object, or a matrix of transmissions.  
    - A cell array of filter names. The output structure  
    will have a field name for each one of these names.  
    * ...,key,val,...  
    'MagSys' - Mag system: ['AB'] | 'Vega'  
    'Device' - Device ['photon'] | 'bol'  
    'Algo' - Algorithm - see astro.spec.synphot  
    Default is 'cos'  
    'Ebv' - E_{B-V} [mag] extinction to apply to  
    spectra. Default is 0.  
    'R' - R_V to use for extinction. Default is 3.08.  
    Output : - A structure array of syntheic magnitudes.  
    Element per object element, and ach filter is  
    stored in a field with its name.  
    - Like Mag results, but for the fraction of  
    extrapolated part of the filter.  
    0 means no extrapolation.  
    - A vector of the filter central wavelengths.  
    Author : Eran Ofek (Aug 2021)  
    Example: AS = AstroSpec.blackBody((4000:10:9000)', [5000; 6000]);  
    [Result, Flag, FilterWave] = synphot(AS, {'SDSS','SDSS'}, {'g','r'})  
    Spec = AstroSpec.synspecGAIA('Temp',[5750 5500 5550],'Grav',[4.5]);  
    Spec = AstroSpec.synspecGAIA('Temp',[5750],'Grav',[4.0, 4.5]);  
    T=[5000 0; 5001 1; 5999 1; 6000 0];   filter transmission  
    Spec.interpOverNan;  
    [Result, Flag, FilterWave] = synphot(Spec, T, 'F55');  
      
      
### synspecGAIA

Load GAIA synthetic spectra and if necessey interpolate over Temperature (other parameters are not interpolated).


    
    Load GAIA synthetic spectra and if necessey interpolate over  
    Temperature (other parameters are not interpolated).  
    Input  : * ...,key,val,...  
    'Temp' - Vector of fffective temperature of spectra [K], in  
    range of 3,500 to 400,000 K.  
    Default is 5750.  
    'GraV' - Vector of surface gravity (log10(cgs)]  
    Default is 4.5  
    'Metal' - Vector of metalicity.  
    Must be in (-2.5:0.5:0.5).  
    Default is 0.  
    'Rot' - Rotation [km/s]. Default is 0.  
    'OutType' - ['astrospec'] | 'astspec' | 'mat'.  
    Outout : - An AstroSpec object with specta.  
    Author : Eran Ofek (Aug 2021)  
    Example: Spec = AstroSpec.synspecGAIA  
    Spec = AstroSpec.synspecGAIA('Temp',[5750 5500 5550],'Grav',[4.5]);  
      
### unitTest

unitTest for AstroSpec


    
    unitTest for AstroSpec  
      
    constructor  
