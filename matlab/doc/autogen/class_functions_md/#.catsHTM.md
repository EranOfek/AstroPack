# Class: catsHTM



    
    catsHTM static class. Read / write HDF5/HTM catalogs  
    Package: @catsHTM  
    Description: A static class for catsHTM related functions.  
    Input  : null  
    Output : null  
    Tested : Matlab R2014a  
    By : Eran O. Ofek                    Jan 2018  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Reliable: 2  
      
      
      
      

### Functions List

    catalogs - List of catsHTM catalogs Example: Data = catsHTM.catalogs
    catalogs_html - generate an html table of catalogs Example: catsHTM.catalogs_html
    cone_search - Cone earch on local HDF5/HTM catalog Package: @catsHTM Description: Perform a cone search around RA/Dec on a local catalog in HDF5 format sorted into HTM.
    count_edge_in_cat - Example: catsHTM.count_edge_in_cat('APASS');
    create_catalog_lists4wget - Create list of catalogs foe wget including checsums
    create_indiv_catalog_lists4wget - Create list of individual catalogs for wget including checsums
    filename2base - Convert HDF5/HTM file name to catalog name (file base name) Package: @catsHTM Description: Convert HDF5/HTM file name (e.g., 'APASS_htm.hdf5') to catalog name (file base name; e.g., 'APASS').
    generate_edge_cat - OBSOLOTE
    get_file_var_from_htmid - Construct file and var name for HTM file stored in HDF5 Package: @catsHTM Description: Given a file base (e.g., 'UCAC4') and HTM ID and number of files in HDF5 file, construct the HDF5 file name (e.g., UCAC4_htm_032400.hdf5),
    get_index_filename - Get HDF5/HTM index file name and variable name from CatName Package: @catsHTM Description: Get HDF5/HTM index file name and variable name from CatName.
    get_nsrc - Count number of sources over all HTM in HDF5 files Package: @catsHTM
    htm_search_cone - Search for all HTM leafs interscting a small circle (cone search) Package: @catsHTM Description: Search for all HTM leafs interscting a small circle (i.e., cone search).
    load_1htm - Load a single tile of HDF5/HTM catalog Package: @catsHTM Description: Load a single HTM tile of HDF5/HTM catalog based on its HTM index. This is slower relative to catsHTM.load_cat,
    load_cat - Load catalog stored in an HDF5 file Package: @catsHTM Description: Load catalog stored in an HDF5 file. Given a a catalog in HDF5 file created by HDF5.save_cat, load the catalog. The catalog is
    load_cat_edge - Load and concat HDF5/HTM catalog and its edge catalog Package: @catsHTM Description: Load and concat HDF5/HTM catalog and its edge catalog
    load_cat_with_edges - load catalogs from all HTMs near a specific HTM triangle. Package: @catsHTM Description:
    load_colcell - Load ColCell and ColUnits for an HDF5/HTM catalog Package: @catsHTM
    load_htm_ind - load HTM data into structure from an HDF5 file Package: @catsHTM Description: load HTM data into structure from an HDF5 file
    load_multiple_cats - Load HDF5/HTM catalog from multiple files/datasets Package: @catsHTM Description: Load HDF5/HTM catalog from multiple files/datasets Not as fast as expected.
    nsrc - Count sources in the HDF5/HTM index file Package: @catsHTM Description: Count sources in the HDF5/HTM index file
    plot_density - Plot a catsHTM catalog surface density Package: @catsHTM Description: Plot a catsHTM catalog surface density in sources per deg^2 or sources per HTM on a celestial sphere map.
    prep_mergedSuperCat - 
    read_colnames - read HDF5 catalog column names from index file Package: @catsHTM
    reference - Get references for an HDF5/HTM catalog Package: @catsHTM Description: Get references for an HDF5/HTM catalog
    save_cat - save catalog data in HDF5 file Package: @catsHTM Description: save catalog data in HDF5 file Given a matrix containing a catalog, save the data in an HDF5 file. The data will be saved
    save_cat_colcell - Save ColCell cell array of an HTM catalog Package: @catsHTM
    save_htm_ind - Save HTM indinces of the celestial sphere in an HDF5 file Package: @catsHTM Description: Generate HDF5 file with HTM indices. The HTM indices contains the HTM tree and the 3 poles of the 3 great circles that defines each
    search_htm_ind - A coordinate cone search in an HTM stored in HDF5 file. Package: @catsHTM Description: A coordinate cone search in an HTM stored in HDF5 file. See also: celestial.htm.htm_search_cone
    serial_search - Execute a function on entire HDF5/HTM catalog Package: @catsHTM Description: Execute a function on entire HDF5/HTM catalog. This can be used for selection of sources based on any parameters.
    serial_search_x - Execute a function on entire HDF5/HTM catalog Package: @catsHTM Description: Execute a function on entire HDF5/HTM catalog. This can be used for selection of sources based on any parameters.
    sources_match - Match sources in an input catalog with catsHTM catalog Package: @catsHTM Description: Given a catalog of sources with their RA/Dec, match each one of them to a source in an catsHTM catalog.
    xmatch_2cats - Cross match two HDF5/HTM catalogs Package: @catsHTM Description: Cross match two HDF5/HTM catalogs. For each source in the first catalog the index of the nearest source, within some distance, in the

### catalogs

List of catsHTM catalogs Example: Data = catsHTM.catalogs


    
    List of catsHTM catalogs  
    Example: Data = catsHTM.catalogs  
      


### catalogs_html

generate an html table of catalogs Example: catsHTM.catalogs_html


    
    generate an html table of catalogs  
    Example: catsHTM.catalogs_html  
      


### cone_search

Cone earch on local HDF5/HTM catalog Package: @catsHTM Description: Perform a cone search around RA/Dec on a local catalog in HDF5 format sorted into HTM.


    
    Cone earch on local HDF5/HTM catalog  
    Package: @catsHTM  
    Description: Perform a cone search around RA/Dec on a local catalog in  
    HDF5 format sorted into HTM.  
    Input  : - Catalog name (e.g., 'GAIADR1').  
    see VO.search.htmcat_names for options.  
    - J2000.0 R.A. [radians, [H M S], or sexagesimal string].  
    - J2000.0 Dec. [radians, [sign D M S], or sexagesimal string].  
    - Search radius [arcsec].  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'Con'         - A cell array of additional  
    constraints to apply to output catalog.  
    Each cell contains a two element  
    cell array in which the first  
    element is a column name on which  
    to apply the constraint. The  
    second element is either a two  
    element vector of [min, max] range  
    to select, or a function handle  
    that get the column and return  
    logical.  
    E.g., {{'Mag_G',[15 16]},{'Plx',@(x) ~isnan(x)}}  
    will select sources with mag  
    between 15 and 16 and not NaN  
    parallax.  
    'RadiusUnits' - Radius units. Default is 'arcsec'.  
    'IndexFileTemplate' - Index Catalog name template.  
    Default is 's_htm.hdf5'.  
    'CatFileTemplate' - Catalog name template.  
    Default is 's_htm_06d.hdf5'.  
    'htmTemplate' - HTM dataset template name.  
    Default is 'htm_06d'.  
    'NcatInFile'  - Number of Datasets in file.  
    Default is 100.  
    'IndexVarName' - Default is [].  
    'UseIndex'    - A logical indicating if to use  
    the index HDF file.  
    For very big catalogs, will be  
    faster to use true.  
    Default is false.  
    'ColRA'       - Default is 1.  
    'ColDec'      - Default is2.  
    'OnlyCone'    - Return only sources within cone.  
    If false will return also some  
    objects outside cone.  
    Default is true.  
    'ColCellFile' - Default is 's_htmColCell.mat'.  
    'OutType'     - Output type {'mat'|'astcat'|'catcl'|'astrocatalog'}.  
    Default is 'mat'.  
    Output : - Catalog of source within cone.  
    - Cell array of column names.  
    License: GNU general public license version 3  
    By : Eran O. Ofek                    Dec 2017  
    URL : http://weizmann.ac.il/home/eofek/matlab/  
    Example: Cat=catsHTM.cone_search('UCAC4',1,1,10);  
    Cat=catsHTM.cone_search('GAIADR1',1,1,10);  
    Cat=catsHTM.cone_search('GALEX',1,1,10);  
    Reliable: 2  
      
      


### count_edge_in_cat

Example: catsHTM.count_edge_in_cat('APASS');


    
      
    Example: catsHTM.count_edge_in_cat('APASS');  


### create_catalog_lists4wget

Create list of catalogs foe wget including checsums


    
    Create list of catalogs foe wget including checsums  
    Input  : - Directory in which the catsHTM catalog resides  
    (e.g., '/raid/eran/catsHTM').  
    - Directory in which to write wget lists.  
    Default is '' - i.e., current dir.  
    Example:  
    catsHTM.create_catalog_lists4wget('/data/euler/catsHTM','/home/eran/');  
      


### create_indiv_catalog_lists4wget

Create list of individual catalogs for wget including checsums


    
    Create list of individual catalogs for wget including checsums  
    Input  : - Directory in which the catsHTM catalog resides  
    (e.g., '/raid/eran/catsHTM').  
    - Directory in which to write wget lists.  
    Default is '' - i.e., current dir.  
    Example:  
    Data=catsHTM.create_indiv_catalog_lists4wget('/data/euler/catsHTM','/home/eran/');  
      
      


### filename2base

Convert HDF5/HTM file name to catalog name (file base name) Package: @catsHTM Description: Convert HDF5/HTM file name (e.g., 'APASS_htm.hdf5') to catalog name (file base name; e.g., 'APASS').


    
    Convert HDF5/HTM file name to catalog name (file base name)  
    Package: @catsHTM  
    Description: Convert HDF5/HTM file name (e.g., 'APASS_htm.hdf5')  
    to catalog name (file base name; e.g., 'APASS').  
    Input  : - HDF5 file name that contains the catalog name.  
    The file name is composed of strings seperated by  
    "_", where the first string is the catalog name.  
    Output : - Catalog name.  
    Example: CatName=catsHTM.filename2base('SDSSDR10_htm.hdf5')  
    Reliable:  
      


### generate_edge_cat

OBSOLOTE


    
    OBSOLOTE  
      


### get_file_var_from_htmid

Construct file and var name for HTM file stored in HDF5 Package: @catsHTM Description: Given a file base (e.g., 'UCAC4') and HTM ID and number of files in HDF5 file, construct the HDF5 file name (e.g., UCAC4_htm_032400.hdf5),


    
    Construct file and var name for HTM file stored in HDF5  
    Package: @catsHTM  
    Description: Given a file base (e.g., 'UCAC4') and HTM ID  
    and number of files in HDF5 file, construct the  
    HDF5 file name (e.g., UCAC4_htm_032400.hdf5),  
    and the data variable name (e.g., htm_032412).  
    Input  : - Catalog base name (e.g., 'UCAC4').  
    - HTM index.  
    - Number of variables in file (default is 100).  
    Output : - File name.  
    If ID is a vector then this is a cell array.  
    - Variable name.  
    If ID is a vector then this is a cell array.  
    Example: [FileName,DataName]=catsHTM.get_file_var_from_htmid('UCAC4',45661,100)  
    Reliable: 2  
      
      


### get_index_filename

Get HDF5/HTM index file name and variable name from CatName Package: @catsHTM Description: Get HDF5/HTM index file name and variable name from CatName.


    
    Get HDF5/HTM index file name and variable name from CatName  
    Package: @catsHTM  
    Description: Get HDF5/HTM index file name and variable name  
    from CatName.  
    Input  : - Catalog name (e.g., 'APASS').  
    Output : - File name (e.g., 'APASS_htm.hdf5')  
    - Variable name (e.g., 'APASS_HTM')  
    Example: [IndexFileName,IndexVarName]=catsHTM.get_index_filename('PS1')  
    Reliable: 2  
      


### get_nsrc

Count number of sources over all HTM in HDF5 files Package: @catsHTM


    
    Count number of sources over all HTM in HDF5 files  
    Package: @catsHTM  
    Input  : - Catalog name (e.g., 'APASSS')  
    Output : - A matrix of [HTM_index, Nsrc]  
    Example: Nsrc=catsHTM.get_nsrc(CatName);  
    Reliable: 2  
      


### htm_search_cone

Search for all HTM leafs interscting a small circle (cone search) Package: @catsHTM Description: Search for all HTM leafs interscting a small circle (i.e., cone search).


    
    Search for all HTM leafs interscting a small circle (cone search)  
    Package: @catsHTM  
    Description: Search for all HTM leafs interscting a small circle  
    (i.e., cone search).  
    Input  : - Either a table of HTM data or an open HDF5 object  
    in which the HTM data is stored.  
    - Longitude [radians] to search.  
    - Latitude [radians] to search.  
    - Search radius [radians].  
    Example:  [HTM,LevList]=celestial.htm.htm_build(4);  
    ID=catsHTM.htm_search_cone(HTM,1,1,0.0001)  
    Reliable : 2  
      


### load_1htm

Load a single tile of HDF5/HTM catalog Package: @catsHTM Description: Load a single HTM tile of HDF5/HTM catalog based on its HTM index. This is slower relative to catsHTM.load_cat,


    
    Load a single tile of HDF5/HTM catalog  
    Package: @catsHTM  
    Description: Load a single HTM tile of HDF5/HTM catalog based  
    on its HTM index.  
    This is slower relative to catsHTM.load_cat,  
    since it also loads the index file.  
    Input  : - Catalog name (e.g., 'APASS').  
    - HTM index.  
    - Number of data varaible in HDF5 file.  
    Default is 100.  
    Output : - Catalog matrix.  
    - Cell array of column names.  
    Example: [Cat,ColCell]=catsHTM.load_1htm('APASS',25000)  
    Reliable: 2  
      


### load_cat

Load catalog stored in an HDF5 file Package: @catsHTM Description: Load catalog stored in an HDF5 file. Given a a catalog in HDF5 file created by HDF5.save_cat, load the catalog. The catalog is


    
    Load catalog stored in an HDF5 file  
    Package: @catsHTM  
    Description: Load catalog stored in an HDF5 file. Given a  
    a catalog in HDF5 file created by  
    HDF5.save_cat, load the catalog. The catalog is  
    sorted by one of the columns and it is possible  
    to retrieve only line in some range. The search  
    is done using the index data.  
    Input  : - HDF5 File name, or catalog name.  
    If catalog name, then second argument must be  
    numeric index.  
    - Variable name from which to load the catalog,  
    or a numeric HTM index.  
    - A two element vector of lower and upper value.  
    Only lines in which the sorted parameter is  
    between the low and high value will be retrieved.  
    If empty, retrieve all lines. Default is empty.  
    - Number of columns in the catalog.  
    Default is empty (will attempt to find it).  
    - Number of HTM data matrix in each hdf5 file.  
    Default is 100.  
    Output : - A matrix containing the catalog  
    Example: Cat=catsHTM.load_cat('APASS_htm_010000.hdf5','htm_010001',[0.1 0.101],20);  
    Cat=catsHTM.load_cat('APASS_htm_043600.hdf5','htm_043601');  
    Cat=catsHTM.load_cat('APASS',43601);  
    Reliable: 2  
      


### load_cat_edge

Load and concat HDF5/HTM catalog and its edge catalog Package: @catsHTM Description: Load and concat HDF5/HTM catalog and its edge catalog


    
    Load and concat HDF5/HTM catalog and its edge catalog  
    Package: @catsHTM  
    Description: Load and concat HDF5/HTM catalog and its edge catalog  
    Input  : - Catalog base name.  
    - HTM index.  
    - Number of HTM datasets in file. Default is 100.  
    Output : - THe catalog.  
    - A logical flag indicating if the Edge catalog was  
    sucessfully uploaded.  
    Example: Cat=catsHTM.load_cat_edge('APASS',19000);  
    Reliable: 2  
      


### load_cat_with_edges

load catalogs from all HTMs near a specific HTM triangle. Package: @catsHTM Description:


    
    load catalogs from all HTMs near a specific HTM triangle.  
    Package: @catsHTM  
    Description:  
    Input  : - Catalog name  
    - Either running index, or HTM index.  
    Running index is a serial number starting with 1.  
    HTM index is the index of the HTM triangle in te HTM  
    structure.  
    The HTM index (Ihtm) is related to the serial number (Ih) by  
    Ihtm   = Level.ptr(Ih).  
    - A logical indicating if the second input is HTM index.  
    Default is true.  
    * Pairs of ...,key,val,...  
    The following keys are available:  
    'HTM' - A structure of HTM generated by celestial.htm.htm_build  
    If empty, then Level must be provided and the HTM will  
    be generated.  
    'LevelH' - A structure of Level generated by celestial.htm.htm_build  
    If empty, then Level must be provided and the HTM will  
    be generated.  
    'Level' - Level number. Ignored if 'HTM' and 'LevelH' are  
    provided.  
    'SearchRadius' - Default is 2.  
    'SearchRadiusUnits' - Default is 'arcsec'.  
    Output : - The combined catalog of all HTMs adjuscent to the requested  
    HTM, including the HTM itself.  
    - A vector of the HTM index for each source in the catalog  
    (first output argument).  
    - The catalog of the requested HTM only.  
    - Cell array of catalog column names.  
    Example:  
    [Cat,CatID,Cat1,Ihtm,ColCell]=catsHTM.load_cat_with_edges('FIRST',1,false,'Level',7);  
      


### load_colcell

Load ColCell and ColUnits for an HDF5/HTM catalog Package: @catsHTM


    
    Load ColCell and ColUnits for an HDF5/HTM catalog  
    Package: @catsHTM  
    Input  : - Catalog base name (e.g., 'DECaLS').  
    Output : - Cell array of column names.  
    - Cell array of column units  
    - Structure with column names and indices  
    Example: [ColCell,ColUnits]=catsHTM.load_colcell('APASS')  
    Reliable: 2  
      


### load_htm_ind

load HTM data into structure from an HDF5 file Package: @catsHTM Description: load HTM data into structure from an HDF5 file


    
    load HTM data into structure from an HDF5 file  
    Package: @catsHTM  
    Description: load HTM data into structure from an HDF5 file  
    Input  : - HDF5 file name containing the HTM data.  
    - Variable name. Default is '<CatName>_HTM'.  
    Output : - A structure array containing the HTM structure.  
    - Thr matrix containing the HTM data.  
    Example: HTM=catsHTM.load_htm_ind('try_htm.hdf5','HTM');  
    Reliable :2  
      


### load_multiple_cats

Load HDF5/HTM catalog from multiple files/datasets Package: @catsHTM Description: Load HDF5/HTM catalog from multiple files/datasets Not as fast as expected.


    
    Load HDF5/HTM catalog from multiple files/datasets  
    Package: @catsHTM  
    Description: Load HDF5/HTM catalog from multiple files/datasets  
    Not as fast as expected.  
    Input  : - CatName  
    - Vector of htm indices.  
    - Number of datasets in HDF5 file. Default is 100.  
    Output : - Joint catalog.  
    Example: Data=catsHTM.load_multiple_cats('UCAC4',[19100:1:191002]')  
    Reliable: 2  
      


### nsrc

Count sources in the HDF5/HTM index file Package: @catsHTM Description: Count sources in the HDF5/HTM index file


    
    Count sources in the HDF5/HTM index file  
    Package: @catsHTM  
    Description: Count sources in the HDF5/HTM index file  
    Input  : - Catalog name (e.g., 'SDSSDR10').  
    Output : - Matrix of [HTMindex, Nsrc].  
    - Total number of sources in catalog.  
    Example: [Nsrc,SumN]=catsHTM.nsrc('SDSSDR10');  
    Reliable: 2  
      


### plot_density

Plot a catsHTM catalog surface density Package: @catsHTM Description: Plot a catsHTM catalog surface density in sources per deg^2 or sources per HTM on a celestial sphere map.


    
    Plot a catsHTM catalog surface density  
    Package: @catsHTM  
    Description: Plot a catsHTM catalog surface density in  
    sources per deg^2 or sources per HTM on a  
    celestial sphere map.  
    Input  : - Catalog name (e.g., 'NVSS');  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'PerDeg2'  - plot density per deg^2.  
    Default is true.  
    Otherwise plot per HTM.  
    'Step'     - Interpolation step in deg.  
    Default is 0.3 deg.  
    'PlotType' - Options are: 'trisurf'|'scatterm'  
    Default is 'scatterm'  
    'MarkerSize'- Marker size for scatterm.  
    Default is 5.  
    'Projection'- Map projection.  
    Default is 'aitoff'.  
    'LogN'     - Plot log10 number of sources.  
    Default is false.  
    Output : - Plot handle.  
    Example: H=catsHTM.plot_density('SDSSDR10')  
      


### prep_mergedSuperCat




    
      
      


### read_colnames

read HDF5 catalog column names from index file Package: @catsHTM


    
    read HDF5 catalog column names from index file  
    Package: @catsHTM  
    Input  : - HDF5 file name.  
    - Variable name. Default is '/ColNames'.  
    Output : - Cell array of column names.  
    - Structure array of column indices.  
    Example: [ColCell,Col]=catsHTM.read_colnames('GAIADR1_htm.hdf5');  
      


### reference

Get references for an HDF5/HTM catalog Package: @catsHTM Description: Get references for an HDF5/HTM catalog


    
    Get references for an HDF5/HTM catalog  
    Package: @catsHTM  
    Description: Get references for an HDF5/HTM catalog  
    Input  : - Catalog base name (e.g., 'GAIADR1').  
    Output : - Structure containing reference and acknowledgment  
    for the catalog.  
    Example: catsHTM.reference('SDSSDR10')  
      
      


### save_cat

save catalog data in HDF5 file Package: @catsHTM Description: save catalog data in HDF5 file Given a matrix containing a catalog, save the data in an HDF5 file. The data will be saved


    
    save catalog data in HDF5 file  
    Package: @catsHTM  
    Description: save catalog data in HDF5 file  
    Given a matrix containing a catalog, save the  
    data in an HDF5 file. The data will be saved  
    under two variable names in the HDF5 file.  
    /<base>_Cat will contain the catalog, while  
    /<base>_Ind will contain an index data.  
    The index data contains two columns [Ind Val],  
    where Val is the values of the sorted column  
    at the line index specified by Ind. Ind are in  
    steps given by the StepRows parameter.  
    Input  : - File name  
    - Base variable name.  
    The actual name will be <base> and <base>_Ind.  
    - Matrix containing the data to save  
    - Column index by which to sort the catalog.  
    - Number of rows step by for which to save the index  
    data. Default is 30.  
    Outout : null  
    Example: catsHTM.save_cat('try_cat.hdf5','V',Data,2,1000);  
    Reliable: 2  
      


### save_cat_colcell

Save ColCell cell array of an HTM catalog Package: @catsHTM


    
    Save ColCell cell array of an HTM catalog  
    Package: @catsHTM  
    Input  : - Catalog name (e.g., 'APASS')  
    - ColCell cell array  
    - ColUnits cell array  
    Reliable : 2  
      


### save_htm_ind

Save HTM indinces of the celestial sphere in an HDF5 file Package: @catsHTM Description: Generate HDF5 file with HTM indices. The HTM indices contains the HTM tree and the 3 poles of the 3 great circles that defines each


    
    Save HTM indinces of the celestial sphere in an HDF5 file  
    Package: @catsHTM  
    Description: Generate HDF5 file with HTM indices.  
    The HTM indices contains the HTM tree and the 3  
    poles of the 3 great circles that defines each  
    HTM.  
    Input  : - Either a structure of HTM to save (created by  
    celestial.htm.htm_build), or the HTM level.  
    - HDF5 File name in which to store the HTM indices.  
    - Variable name in which to store the data.  
    Default is '<CatName>_HTM'  
    - Cell array of attribute {Key,Val} to save  
    in a 'ColCell' variable name.  
    - Nsrc matrix [IndHTM Nsrc]  
    Output : null  
    Example: catsHTM.save_htm_ind(7,'try_htm.hdf5',[],{},Nsrc)  
    Reliable: 2  
      


### search_htm_ind

A coordinate cone search in an HTM stored in HDF5 file. Package: @catsHTM Description: A coordinate cone search in an HTM stored in HDF5 file. See also: celestial.htm.htm_search_cone


    
    A coordinate cone search in an HTM stored in HDF5 file.  
    Package: @catsHTM  
    Description: A coordinate cone search in an HTM stored in HDF5 file.  
    See also: celestial.htm.htm_search_cone  
    Input  : - An HDF5 file name or an open HDF5 object, in which  
    the HTM indices are stored.  
    - Variable name. If empty, default is <CatName>_HTM.  
    - Search longitude [radians].  
    - Search latitude [radians].  
    - Search radius [radians].  
    Example: ID=catsHTM.search_htm_ind('UCAC4_htm.hdf5',[],1,1,0.001)  
    Reliable: 2  
      
      


### serial_search

Execute a function on entire HDF5/HTM catalog Package: @catsHTM Description: Execute a function on entire HDF5/HTM catalog. This can be used for selection of sources based on any parameters.


    
    Execute a function on entire HDF5/HTM catalog  
    Package: @catsHTM  
    Description: Execute a function on entire HDF5/HTM catalog.  
    This can be used for selection of sources based  
    on any parameters.  
    Input  : - Catalog name (e.g., 'GAIADR1').  
    - Function name to execute:  
    Fun(Cat,FunPar{:})  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'Concat' - Concat results to previous results.  
    Default is true.  
    Concat result will be outputed as  
    second output argument.  
    'FunPar' - Cell array of additional parameters to  
    pass to the function.  
    'NparPool' - Number of parallel processes to run.  
    Default is 24.  
    'Xmatch'   - A logical flag indicating if to  
    prepare a list of all sources in the  
    current HTM and neighbooring HTMs.  
    This will be used by FunX.  
    Default is false.  
    'FunX'     - A function to call if Xmatch is true.  
    Default is [].  
    FunX(Cat,CatNeigh,varargin)  
    'FunXPar'  - A cell array of key,val atruments to  
    pass to FunX as additional parameters.  
    'SearchRadius' - Search radius for FunX. Default  
    is 100 arcsec.  
    'SearchRadiusUnits' - Default is 'arcsec'.  
    'Verbose' - Default is true.  
    Output : - Cell array of column names in catalog.  
    - Optional concat results.  
    Example: [ColCell]=catsHTM.serial_search('APASS',@sin)  
    Reliable: 2  
      


### serial_search_x

Execute a function on entire HDF5/HTM catalog Package: @catsHTM Description: Execute a function on entire HDF5/HTM catalog. This can be used for selection of sources based on any parameters.


    
    Execute a function on entire HDF5/HTM catalog  
    Package: @catsHTM  
    Description: Execute a function on entire HDF5/HTM catalog.  
    This can be used for selection of sources based  
    on any parameters.  
    Input  : - Catalog name (e.g., 'GAIADR1').  
    - Function name to execute:  
    Fun(Cat,FunPar{:})  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'Istart' - Default is 1.  
    'Iend'   - Default is inf.  
    'FunPar' - Cell array of additional parameters to  
    pass to the function.  
    'NparPool' - Number of parallel processes to run.  
    Default is 24.  
    'Xmatch'   - A logical flag indicating if to  
    prepare a list of all sources in the  
    current HTM and neighbooring HTMs.  
    This will be used by FunX.  
    Default is false.  
    'FunX'     - A function to call if Xmatch is true.  
    Default is [].  
    FunX(Cat,CatNeigh,varargin)  
    'FunXPar'  - A cell array of key,val atruments to  
    pass to FunX as additional parameters.  
    'SearchRadius' - Search radius for FunX. Default  
    is 100 arcsec.  
    'SearchRadiusUnits' - Default is 'arcsec'.  
    Output : - Cell array of column names in catalog.  
    Example: catsHTM.serial_search_x('GAIADR2',[],'FunX',@search_allml,'Xmatch',true)  
    [~,ConCat]=catsHTM.serial_search_x('LAMOSTDR6',[],'FunX',@search_duplicate,'Xmatch',true)  
    Reliable: 2  
      


### sources_match

Match sources in an input catalog with catsHTM catalog Package: @catsHTM Description: Given a catalog of sources with their RA/Dec, match each one of them to a source in an catsHTM catalog.


    
    Match sources in an input catalog with catsHTM catalog  
    Package: @catsHTM  
    Description: Given a catalog of sources with their RA/Dec,  
    match each one of them to a source in an  
    catsHTM catalog.  
    Input  : - catsHTM catalog name (e.g., 'UCAC4').  
    - An AstCat object with sources.  
    * Arbitrary number of key,val pairs:  
    'ConeSearchPar' - A cell array of additional  
    arguments to pass to cone_search.m.  
    E.g.,  {{'Mag_G',[15 16]},{'Plx',@(x) ~isnan(x)}}  
    Default is {}.  
    'OutType' - Output catalog type {'mat'|'astcat'}.  
    Default is 'AstCat'.  
    'SearchRadius' - Search radius. Default is 2.  
    'SearchRadiusUnits' - Search radius units.  
    Default is 'arcsec'.  
    'ColCell' - Default is {}.  
    'ColRA' - Default is {'RA','ALPHAWIN_J2000'}.  
    'ColDec' - Default is {'Dec','DELTAWIN_J2000'}.  
    'CooUnits' - Input catalog coordinates units.  
    Default is 'rad'.  
    'ColDecHTM' - Default is 2.  
    'ColRAHTM'  - Default is 1.  
    Output : - A matched catalog.  
    Example: CatM=catsHTM.sources_match('GAIADR2',CoaddSim);  
      


### xmatch_2cats

Cross match two HDF5/HTM catalogs Package: @catsHTM Description: Cross match two HDF5/HTM catalogs. For each source in the first catalog the index of the nearest source, within some distance, in the


    
    Cross match two HDF5/HTM catalogs  
    Package: @catsHTM  
    Description: Cross match two HDF5/HTM catalogs. For each  
    source in the first catalog the index of the  
    nearest source, within some distance, in the  
    second catalog is saved.  
    Input  : - Catalog base name.  
    - Catalog base name.  
    * Arbitrary number of pairs of arguments: ...,keyword,value,...  
    where keyword are one of the followings:  
    'SearchRadius' - Search radius. Default is 2''.  
    'SearchRadiusUnits' - Search radius units.  
    Default is 'arcsec'.  
    'QueryFun'    - Optional function handle to  
    execute on the matched catalog.  
    Syntax:  
    Flag = QueryFun(Cat1,Cat2matched,QueryFunPar{:});  
    where Flag is a vector logicals  
    indicating the selected rows to be  
    saved.  
    'QueryFunPar' - Cell array of additional arguments  
    to pass to QueryFun.  
    Default is {}.  
    'SaveFun' - Optional function handle to execute on  
    the queried matched catalog.  
    SaveFun(Cat1,Cat2matched,SaveFunPar{:});  
    E.g., to save the data.  
    'SaveFunPar' - Cell array of additional arguments  
    to pass to SaveFun.  
    Default is {}.  
    'Cat2_ColDec' - Declination column in second  
    catalog. Default is 2.  
    'NparPool' - Number of parallel processes to run.  
    Default is 24.  
    'DeleteParPool' - Delete existing parpool.  
    Default is false.  
    Output : null [output is written as an HDF5/HTM catalog].  
    Example: catsHTM.xmatch_2cats('APASS','APASS')  
    Reliable: 2  
      


