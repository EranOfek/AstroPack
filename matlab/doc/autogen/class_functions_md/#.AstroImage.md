# Class: AstroImage



    
    Astronomical images container class  
    This class provides a container for images and images meta data, as  
    well as basic functionality for image manipulation.  
    Properties (Dependent):  
    Image  
    Back  
    Var  
    Mask  
    Header  
    Key  
    Cat  
    PSF  
    Properties:  
    ImageData  
    BackData  
    VarData  
    MaskData  
    HeaderData  
    CatData  
    PSFData  
    WCS  
    PropagateErr  
    Functionality:  
    AstroImage - Constructor and image reader for AstroImage class  
    isemptyImage - Check if data images in AstroImage object are empty  
    sizeImage - Return the size of images in AstroImage object.  
    astroImage2ImageComponent - Convert an AstroImage data into SciImage, BackImage, etc. objects.  
    astroImage2AstroCatalog - Convert the CataData in AstroImage object into an AstroCatalog object array.  
    cast - Cast the image/back/var data in AstroImage (transform to a new type)  
    funCat - Apply function of Cat properties in AstroImage array.  
    funHeader - Apply function of HeaderData properties in AstroImage array.  
    funHeaderScalar - Apply function that return a scalar on HeaderData properties in AstroImage array  
    getStructKey - Get multiple keys from headers in multiple AstroImage and store in a structure array  
    funWCS - Apply function of WCS properties in AstroImage array  
    funPSF - Apply function of PSF properties in AstroImage array  
    maskSet - Set the value of a bit in a bit mask (Maskdata) in AstroImage  
    isImType - Check if header IMTYPE keyword value equal some type  
    julday - Return the Julian day for AstroImage object  
    funUnary - Apply an unary function on AstroImage object.  
    funUnaryScalar - Apply a unary operator that return scalar on AstroImage and return an numeric array  
    funBinaryProp - Apply binary function on a single property of AstroImage  
    funBinaryImVar - Apply a binary operator with error propagation to the  
    funBinary - Apply a binary operator to AstroImage  
    crop - crop an AstroImage images and catalogs and update WCS  
    object2array - Convert an AstroImage object that contains scalars into an array  
    plus - Apply the plus operator between AstroImage objects.  
    minus - Apply the minus operator between AstroImage objects.  
    times - Apply the times operator between AstroImage objects.  
    rdivide - Apply the rdivide operator between AstroImage objects.  
    conv - Convolve images with their PSF, or another PSF  
    filter - Filter images with their PSF, or another PSF  
      
    Functionality (Static):  
    imageIO2AstroImage - Convert an ImageIO object into an AstroImage object  
    readImages2AstroImage - Create AstroImage object and read images into a specific property.  
    unitTest - unitTest for AstroImage  
      
      
      
      

### Functions List

    AstroImage - Constructor and image reader for AstroImage class
    astroImage2AstroCatalog - Convert the CataData in AstroImage object into an AstroCatalog object array.
    astroImage2ImageComponent - Convert an AstroImage data into SciImage, BackImage, etc. objects.
    cast - Cast the image/back/var data in AstroImage (transform to a new type)
    conv - Convolve images with their PSF, or another PSF
    copyElement - Custom copy of object properties Called from copy() of matlab.mixin.Copyable decendents
    crop - crop an AstroImage images and catalogs and update WCS
    filter - Filter images with their PSF, or another PSF
    funBinary - Apply a binary operator to AstroImage
    funBinaryImVar - Apply a binary operator with error propagation to the ImageData and VarData in an AstroImage object.
    funBinaryProp - Apply binary function on a single property of AstroImage without error propagation.
    funCat - Apply function of Cat properties in AstroImage array This function doesn't create a new object
    funHeader - Apply function of HeaderData properties in AstroImage array This function doesn't create a new object
    funHeaderScalar - Apply function that return a scalae on HeaderData properties in AstroImage array
    funPSF - Apply function of PSF properties in AstroImage array
    funUnary - Apply an unary function on AstroImage object. This include applying the function  on specific data fields, and or image sections (CCDSEC), and error propagation. Note that error propgation is activated using the
    funUnaryScalar - Apply a unary operator that return scalar on AstroImage and return an numeric array
    funWCS - Apply function of WCS properties in AstroImage array
    get.Back - getter for BackImage
    get.Header - getter for Header
    get.Image - getter for Image - get image from ImageData property
    get.Key - getter for Header keys
    get.Mask - getter for MaskImage
    get.Var - getter for VarImage
    get.WCS - getter for WCS if empty, attempt to create from header
    getStructKey - Get multiple  keys from headers in multiple AstroImage and store in a structure array The keyword search can be exact (UseDict=false), or using a keywords dictionary (UseDict=true).
    imageIO2AstroImage - Convert an ImageIO object into an AstroImage object
    isImType - Check if header IMTYPE keyword value equal some type
    isemptyImage - Check if data images in AstroImage object are empty
    julday - Return the Julian day for AstroImage object
    maskSet - Set the value of a bit in a bit mask (Maskdata) in AstroImage
    minus - Apply the minus operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI - AI
    object2array - Convert an AstroImage object that contains scalars into an array
    perfTest - perfTest for the AstroImage class
    perfTestMat - Low level perfTest for the Matlab matrix
    plus - Apply the plus operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI + AI
    prepOperand2 - Prepare the 2nd operand for binary operation
    propagateWCS - Given An AstroImage with WCS property, propagate it to the header and catalog
    rdivide - Apply the rdivide operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI ./ AI
    readImages2AstroImage - Create AstroImage object and read images into a specific property.
    set.Back - setter for BackImage
    set.Image - setter for Image - store image in ImageData property Obj.(Relations.Image).Image = Data;   can use this instead
    set.Mask - setter for MaskImage
    set.Var - setter for VarImage
    setKeyVal - Replace/insert keyword/value to HeaderData in AstroImage
    sizeImage - Return the size of images in AstroImage object
    times - Apply the times operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI .* AI
    unitTest - unitTest for AstroImage Example: AstroImage.unitTest

### AstroImage

Constructor and image reader for AstroImage class


    
    Constructor and image reader for AstroImage class  
    Input  : - A file name, files, or cell of matrices.  
    * ...,key,val,...  
    'HDU' - HDU number. Default is 1.  
    'Scale' - Image scale. Default is [].  
    'ReadHeder' - A logical indicating if to read  
    header. Default is true.  
    'Back' - The same as the file name argument, but  
    for a background image. Default is [].  
    'BackHDU' - The same as HDU, but for the  
    background image. Default is [].  
    'BackScale' - The same as scale, but for the  
    background image. Default is [].  
    'Var' - The same as the file name argument, but  
    for a variance image. Default is [].  
    'VarHDU' - The same as HDU, but for the  
    variance image. Default is [].  
    'VarScale' - The same as scale, but for the  
    variance image. Default is [].  
    'Mask' - The same as the file name argument, but  
    for a mask image. Default is [].  
    'MaskHDU' - The same as HDU, but for the  
    mask image. Default is [].  
    'MaskScale' - The same as scale, but for the  
    mask image. Default is [].  
    'FileType' - If empty, use auto detection.  
    Default is [].  
    'UseRegExp' - Ues regexp for file name  
    interpretation. Default is false.  
    Output : - An AstroImage object.  
    Author : Eran Ofek (Jun 2021)  
    Example:  
    AI = AstroImage([2 2]);  
    AI = AstroImage(FileNames,'HDU',1);  
    AI = AstroImage(FileNames,'HDU',1,'Back',FileNames,'BackHDU',2);  
    AI = AstroImage(FileNames,'HDU',1,'Back',FileNamesBack,'BackHDU',1);  
    AI = AstroImage({rand(10,10)},'Back',{rand(5,5)},'BackScale',2,'var',{rand(5,5)},'VarScale',2);  
      


### astroImage2AstroCatalog

Convert the CataData in AstroImage object into an AstroCatalog object array.


    
    Convert the CataData in AstroImage object into an AstroCatalog object array.  
    Input  : - An AstroImage object (multi components supported).  
    * ...,key,val,...  
    'CreateNewObj' - A logical indicating if to create  
    a new object or to provide and handle to  
    the existing object. Default is false.  
    Output : - An astroCatalog object.  
    Note that if CreateNewObj=false then changes in  
    this object will take place also in the original  
    AstroImage object.  
    Author : Eran Ofek (Apr 2021)  
    Example: AC= astroImage2AstroCatalog(AI);  
    AC= astroImage2AstroCatalog(AI,'CreateNewObj',true);  
      


### astroImage2ImageComponent

Convert an AstroImage data into SciImage, BackImage, etc. objects.


    
    Convert an AstroImage data into SciImage, BackImage, etc. objects.  
    Input  : - An AstroImage object (multiple elements supported)  
    * ...,key,val,...  
    'ReturnImageComponent' - A logical indicating if  
    to return an ImageComponent class, or the  
    native class of the data object (e.g.,  
    SciImage). Default is false.  
    'CreateNewObj' - A logical indicating if to create  
    a new object. Default is false.  
    Note this parameter must be a logical and  
    it is independent of nargout.  
    'DataProp' - A list of Data properties to copy.  
    Default is {'ImageData','BackData',  
    'VarData', 'MaskData'}.  
    The output are returned by this order.  
    Output : * An object per requested DataProp.  
    By default, the first output arg is a SciImage  
    object containing all the Images, etc.  
    Author : Eran Ofek (Apr 2021)  
    Example: [S,B] = astroImage2ImageComponent(AI)  
    [S,B] = astroImage2ImageComponent(AstroImage([2 2]))  
    [S,B] = astroImage2ImageComponent(AI,'CreateNewObj',true)  
    [S,B] = astroImage2ImageComponent(AI,'CreateNewObj',true,'ReturnImageComponent',true)  
      


### cast

Cast the image/back/var data in AstroImage (transform to a new type)


    
    Cast the image/back/var data in AstroImage (transform to a new type)  
    Input  : - An AstroImage object.  
    - A char array containing the new type.  
    Default is 'single'.  
    - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    Default is false.  
    - A cell array of data properties which to transform  
    to the new class. Default is  
    {'ImageData','BackData','VarData'}.;  
    Output : - An ImageComponent object in which the image 'Data'  
    is transformed into the new type.  
    Author : Eran Ofek (May 2021)  
    Example: AI = AstroImage({rand(10,10)},'Back',{rand(10,10)});  
    Res = cast(AI,'single');  
      


### conv

Convolve images with their PSF, or another PSF


    
    Convolve images with their PSF, or another PSF  
    Input  : - An AstroImage object.  
    - PSF/kernel with which to convolve the input image.  
    This can be one of the following:  
    1. A matrix.  
    2. A function handle: Fun(Args.ArgsPSF{:})  
    3. AstroPSF object (multiple elements supported)  
    4. ImageComponent (multiple elements supported)  
    5. AstroImage object (multiple) use the .ImageData.Image field.  
    6. empty.  
    If empty, then will attempt to use the AstroPSF  
    object in the AstroImage object.  
    Default is [].  
    * ...,key,val,...  
    'ArgsPSF' - A cell array of arguments to pass to  
    the getPSF function of AstroPSF or to the  
    function_handle (if the PSF is a function).  
    Default is {}.  
    'UseFFT' - A logical indicating if to use fft or direct  
    convolution. If empty, use faster method  
    for the specific image and kernel sizes.  
    Default is [].  
    'PadMethod' - Padding before operation (padded region  
    will be removed from output).  
    '' - do nothing (Default).  
    'circular' - circular boundry conditions.  
    'replicate' - relpicate nearest edge value.  
    'symmetric' - mirror reflection boundry conditions.  
    'DataProp' - A cell array of data properties on  
    which to aplly the operator.  
    Default is {'ImageData'}.  
    'DataPropIn' - Data property in the ImageComponent  
    on which to apply the operator.  
    Default is 'Image'.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    Output : - An AstroImage object in which the operator applied  
    to the images.  
    Author : Eran Ofek (May 2021)  
    Example: AI = AstroImage({rand(100,100), rand(200,200)});  
    AI.conv(imUtil.kernel2.annulus);  
    Mat = zeros(30,30); Mat(15,15)=1;  
    AI = AstroImage({Mat});  
    Res = conv(AI, @imUtil.kernel2.gauss)  
      


### copyElement

Custom copy of object properties Called from copy() of matlab.mixin.Copyable decendents


    
    Custom copy of object properties  
    Called from copy() of matlab.mixin.Copyable decendents  
      
    Make shallow copy of all properties  


### crop

crop an AstroImage images and catalogs and update WCS


    
    crop an AstroImage images and catalogs and update WCS  
    Input  : - An AstroImage object.  
    - A CCDSEC [xmin, xmax, ymin, ymax]  
    or 'center' [Xcenter, Ycenter, Xhalfsize, Yhalfsize].  
    If multiple lines then each line corresponding to  
    an AstroImage element.  
    If empty, then do not crop.  
    * ...,key,val,...  
    'Type' - ['ccdsec'] | 'center'  
    'DataProp' - A cell array of image data properties  
    to crop. Default is {'ImageData','BackData','VarData','MaskData'}  
    'DataPropIn' - Data property on which to operate.  
    Default is 'Image'.  
    'UpdateCat' - A logical indicating if to crop  
    catalog by XY (using cropXY). Default is true.  
    'cropXYargs' - A cell array of arguments to pass  
    to AstroCatalog/cropXY. Default is {}.  
    'UpdateHeader' - A logical indicating if to update  
    the {'NAXIS1','NAXIS2','CCDSEC','ORIGSEC'}  
    header keywords. Default is true.  
    'UpdateWCS' - A logical indicating if to update  
    the WCS. Default is true.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    Output : - A cropped AstroImage object.  
    Author : Eran Ofek (Jul 2021)  
    Example: AI = AstroImage({rand(100,100),rand(100,200)},'Back',{rand(100,100),rand(100,200)});  
    Res = crop(AI,[11 20 11 30])  
      


### filter

Filter images with their PSF, or another PSF


    
    Filter images with their PSF, or another PSF  
    Input  : - An AstroImage object.  
    - PSF/kernel with which to filter (cross-corelate) the input image.  
    This can be one of the following:  
    1. A matrix.  
    2. A function handle: Fun(Args.ArgsPSF{:})  
    3. AstroPSF object (multiple elements supported)  
    4. ImageComponent (multiple elements supported)  
    5. AstroImage object (multiple) use the .ImageData.Image field.  
    6. empty.  
    If empty, then will attempt to use the AstroPSF  
    object in the AstroImage object.  
    Default is [].  
    * ...,key,val,...  
    'ArgsPSF' - A cell array of arguments to pass to  
    the getPSF function of AstroPSF or to the  
    function_handle (if the PSF is a function).  
    Default is {}.  
    'UseFFT' - A logical indicating if to use fft or direct  
    convolution. If empty, use faster method  
    for the specific image and kernel sizes.  
    Default is [].  
    'PadMethod' - Padding before operation (padded region  
    will be removed from output).  
    '' - do nothing (Default).  
    'circular' - circular boundry conditions.  
    'replicate' - relpicate nearest edge value.  
    'symmetric' - mirror reflection boundry conditions.  
    'DataProp' - A cell array of data properties on  
    which to aplly the operator.  
    Default is {'ImageData'}.  
    'DataPropIn' - Data property in the ImageComponent  
    on which to apply the operator.  
    Default is 'Image'.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    Output : - An AstroImage object in which the operator applied  
    to the images.  
    Author : Eran Ofek (May 2021)  
    Example: AI = AstroImage({rand(100,100), rand(200,200)});  
    AI.filter(imUtil.kernel2.annulus);  
    Mat = zeros(30,30); Mat(15,15)=1;  
    AI = AstroImage({Mat});  
    Res = filter(AI, @imUtil.kernel2.gauss)  
      


### funBinary

Apply a binary operator to AstroImage


    
    Apply a binary operator to AstroImage  
    Input  : - 1st operand - An AstroImage object.  
    - 2nd operand - An AstroImage object or a  
    cell array of matrices, or an array of numbers.  
    If a cell array each element of the cell array  
    will be treated as the 2nd operand image.  
    If a vector than this will be treated as a single  
    image.  
    - Operator (a function handle). E.g., @plus.  
    * ...,key,val,...  
    'OpArgs' - A cell array of additional arguments to  
    pass to the operator. Default is {}.  
    'CalcImage' - A logical that state if to apply the  
    operator to the ImageData property.  
    Default is true.  
    'CalcBack' - A logical that state if to apply the  
    operator to the BackData property.  
    Default is true.  
    'CalcVar' - A logical that state if to apply the  
    operator to the VarData property.  
    Default is true.  
    'CalcMask' - A logical that state if to apply the  
    operator to the MaskData property.  
    Default is true.  
    'CalcPSF' - A logical that state if to apply the  
    operator to the PSF property.  
    Default is true.  
    'PropagateErr' - A logical stating if to apply  
    error propagation. If empty, then use the  
    object PropagateErr property. Default is  
    [].  
    NOTE THAT the first element state dicatates  
    all the rest.  
    'DeleteCat' - A logical indicating if to delete  
    the catalog data. Default is false.  
    'UpdateHeader' - a logical indicating if to update  
    the header. Default is true.  
    'DataPropIn' - Data property of the ImageComponent  
    on which to operate. Default is 'Data'.  
    'CCDSEC1' - [Xmin Xmax Ymin Ymax] CCDSEC for the  
    1st oprand. The Operator will be applied  
    only on this section.  
    If empty, use all image. Default is [].  
    'CCDSEC2' - The same as CCDSEC1, but for the 2nd  
    operand. Default is [].  
    'CCDSEC' - The CCDSEC in the output image. Must be  
    of the same size as CCDSEC1 and CCDSEC2.  
    'UseOrForMask' - A logical indicating if to use  
    the @bitor operator instead of the input operator  
    if the requested data property is  
    'MaskImage'. Default is true.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    'Result' - An AstroImage object in which the  
    results will be written. If empty, then use  
    the CreateNewObj scheme.  
    Default is [].  
    Output : An AstroImage object  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({ones(3,3)});  
    Result = funBinary(AI,3,@plus)  
    AI = AstroImage({3.*ones(3,3)}, 'Back',{ones(3,3)}, 'Var',{3.*ones(3,3)});  
    Result = funBinary(AI,3,@plus)  
    Result = funBinary(AI,3,@plus,'PropagateErr',true)  
      


### funBinaryImVar

Apply a binary operator with error propagation to the ImageData and VarData in an AstroImage object.


    
    Apply a binary operator with error propagation to the  
    ImageData and VarData in an AstroImage object.  
    Input  : - 1st operand - An AstroImage object.  
    - 2nd operand - An AstroImage object or a  
    cell array of matrices, or an array of numbers.  
    If a cell array each element of the cell array  
    will be treated as the 2nd operand image.  
    If a vector than this will be treated as a single  
    image.  
    - Operator (a function handle). E.g., @plus.  
    * ...,key,val,...  
    'OpArgs' - A cell array of additional arguments to  
    pass to the operator. Default is {}.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    'CCDSEC1' - [Xmin Xmax Ymin Ymax] CCDSEC for the  
    1st oprand. The Operator will be applied  
    only on this section.  
    If empty, use all image. Default is [].  
    'CCDSEC2' - The same as CCDSEC1, but for the 2nd  
    operand. Default is [].  
    'CCDSEC' - The CCDSEC in the output image. Must be  
    of the same size as CCDSEC1 and CCDSEC2.  
    'DataPropIn' - Data property of the ImageComponent  
    on which to operate. Default is 'Data'.  
    'Result' - An AstroImage object in which the  
    results will be written. If empty, then use  
    the CreateNewObj scheme.  
    Default is [].  
    Output : - An AstroImage object.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({ones(3,3)},'Var',{ones(3,3)})  
    Res = funBinaryImVar(AI,AI,@plus);  
    Res = funBinaryImVar(AI,AI,@minus);  
    Res = funBinaryImVar(AI,3,@times);  
      


### funBinaryProp

Apply binary function on a single property of AstroImage without error propagation.


    
    Apply binary function on a single property of AstroImage  
    without error propagation.  
    Input  : - 1st operand - An AstroImage object.  
    - 2nd operand - An AstroImage object or a  
    cell array of matrices, or an array of numbers.  
    If a cell array each element of the cell array  
    will be treated as the 2nd operand image.  
    If a vector than this will be treated as a single  
    image.  
    - Operator (a function handle). E.g., @plus.  
    * ...,key,val,...  
    'OpArgs' - A cell array of additional arguments to  
    pass to the operator. Default is {}.  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    'CCDSEC1' - [Xmin Xmax Ymin Ymax] CCDSEC for the  
    1st oprand. The Operator will be applied  
    only on this section.  
    If empty, use all image. Default is [].  
    'CCDSEC2' - The same as CCDSEC1, but for the 2nd  
    operand. Default is [].  
    'CCDSEC' - The CCDSEC in the output image. Must be  
    of the same size as CCDSEC1 and CCDSEC2.  
    'DataProp' - Data property on which to operate.  
    Default is 'ImageData'.  
    'DataPropIn' - Data property of the ImageComponent  
    on which to operate. Default is 'Data'.  
    'UseOrForMask' - A logical indicating if to use  
    the @bitor operator instead of the input operator  
    if the requested data property is  
    'MaskImage'. Default is true.  
    'Result' - An AstroImage object in which the  
    results will be written. If empty, then use  
    the CreateNewObj scheme.  
    Default is [].  
    Output : - An AstroImage object.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI=AstroImage({ones(3,3)});  
    Res = funBinaryProp(AI,3,@plus);  
    Res = funBinaryProp(AI,[3 2 1 2],@plus);  
    Res = funBinaryProp(AI,{2 1},@plus);  
    Res = funBinaryProp(AI,AI,@minus)  
      


### funCat

Apply function of Cat properties in AstroImage array This function doesn't create a new object


    
    Apply function of Cat properties in AstroImage array  
    This function doesn't create a new object  
    Input  : - AstroImage object  
    - An AstroCatalog function handle.  
    * Additional arguments to pass to the function.  
    Output : * If no output argument is specified then this  
    will modify the input object with the updated Cat.  
    If output argument is specified then the output will be  
    written to this output.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({rand(10,10), rand(10,10)});  
    AI(1).CatData.Catalog=rand(10,2);  
    AI(2).CatData.Catalog=rand(10,2);  
    funCat(AI,@sortrows,1);  
      


### funHeader

Apply function of HeaderData properties in AstroImage array This function doesn't create a new object


    
    Apply function of HeaderData properties in AstroImage array  
    This function doesn't create a new object  
    Input  : - AstroImage object  
    - An AstroHeader function handle.  
    * Additional arguments to pass to the function.  
    Output : * If no output argument is specified then this  
    will modify the input object with the updated Header.  
    If output argument is specified then the output will be  
    written to this output.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({rand(10,10), rand(10,10)});  
    funHeader(AI,@insertKey,{'GAIN',2,''});  
      


### funHeaderScalar

Apply function that return a scalae on HeaderData properties in AstroImage array


    
    Apply function that return a scalae on HeaderData properties in AstroImage array  
    Input  : - AstroImage object  
    - An AstroHeader function handle.  
    * Additional arguments to pass to the function.  
    Output : - An array in which each element corresponds to the  
    result of applying the function on a single element  
    of the AStroImage object.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({rand(10,10), rand(10,10)});  
    funHeaderScalar(AI,@julday)  
      


### funPSF

Apply function of PSF properties in AstroImage array


    
    Apply function of PSF properties in AstroImage array  


### funUnary

Apply an unary function on AstroImage object. This include applying the function  on specific data fields, and or image sections (CCDSEC), and error propagation. Note that error propgation is activated using the


    
    Apply an unary function on AstroImage object.  
    This include applying the function  on specific data  
    fields, and or image sections (CCDSEC), and error  
    propagation.  
    Note that error propgation is activated using the  
    AstroImage.PropagateErr property (default is false).  
    Input  : - An AstroImage object (multi elements supported)  
    - Operator (function_handle) (e.g., @sin)  
    * ...,key,val,...  
    'OpArgs' - A cell array of additional arguments to  
    pass to the operator. Default is {}.  
    'PropagateErr' - If empty, will use the object  
    PropagateErr property. Otherwise will set  
    it using the new value. Default is [].  
    'CreateNewObj' - Logical indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false)  
    Default is false (i.e., input object will  
    be modified).  
    'CCDSEC' - CCDSEC on which to operate:  
    [Xmin, Xmax, Ymin, Ymax].  
    Use [] for the entire image.  
    If not [], then DataPropIn/Out will be  
    modified to 'Image'.  
    'OutOnlyCCDSEC' - A logical indicating if the  
    output include only the CCDSEC region, or  
    it is the full image (where the opeartor,  
    operated only on the CCDSEC region).  
    Default is true.  
    'CalcImage' - A logical indicating if to apply the  
    operator to the Image field.  
    Default is true.  
    'CalcVar' - A logical indicating if to apply the  
    operator to the Var field.  
    Default is true.  
    'CalcBack' - A logical indicating if to apply the  
    operator to the Back field.  
    Default is true.  
    'ReturnBack' - A logical indicating if to return  
    the background to the image before applying  
    the operator. Default is true.  
    'ReRemoveBack' - A logical indicating if to remove  
    the background from the image after  
    applying the operator (relevant only if the  
    SciImage.IsBackSubtracted=true).  
    Default is true.  
    'UpdateHeader' - A logical indicating if to update  
    the header of the output image.  
    Default is true.  
    'AddHistory' - A logical indicating if to add an  
    HISTORY line in the header specifying the  
    operation. Default is true.  
    'NewUnits' - If empty do nothing. If provided will  
    put this value in the header 'UNITS' key.  
    Default is [].  
    'InsertKeys' - A cell array of 3 columns cell  
    array {key,val,comment}, to insert to the  
    header. Default is {}.  
    'ReplaceKeys' - A cell array of keywords to  
    replace. Default is {}.  
    'ReplaceVals' - A cell array of keywords values to  
    replace (corresponding top ReplaceKeys).  
    Default is {}.  
    'replaceValArgs' - A cell array of additional  
    arguments to pass to the replaceVal function.  
    Default is {}.  
    'insertKeyArgs' - A cell array of additional  
    arguments to pass to the insertKey function.  
    Default is {}.  
    'DeleteCat' - A logical indicating if to delete  
    the catalog data. Default is false.  
    'ImCompDataPropIn' - Data property in the  
    ImageComponent on which the operator  
    will be operated. Default is 'Data'.  
    'ImCompDataPropOut' - Data property in the  
    ImageComponent in which the output  
    will be stored. Default is 'Data'.  
    Output : - An AstroImage object with the operator applied on  
    the data.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({10.*ones(10,10)},'Back',{ones(5,5)},'BackScale',2,'var',{ones(5,5)},'VarScale',2);  
    B=AI.funUnary(@sin,'CreateNewObj',true)  
    B=AI.funUnary(@mean,'OpArgs',{'all'})  
    AI.PropagateErr=true; B=AI.funUnary(@mean,'OpArgs',{'all'})  
    B=AI.funUnary(@median,'OpArgs',{'all'});  must result in error  
    B=AI.funUnary(@median,'OpArgs',{'all'},'PropagateErr',false,'OperateOnVar',true)  
      


### funUnaryScalar

Apply a unary operator that return scalar on AstroImage and return an numeric array


    
    Apply a unary operator that return scalar on AstroImage and return an numeric array  
    Input  : - An AstroImage object (multi elements supported)  
    - Operator (a function handle, e.g., @mean).  
    * ...,key,val,...  
    'OpArgs' - A cell array of additional arguments to  
    pass to the operator. Default is {}.  
    'CCDSEC' - CCDSEC on which to operate:  
    [Xmin, Xmax, Ymin, Ymax].  
    Use [] for the entire image.  
    If not [], then DataPropIn/Out will be  
    modified to 'Image'.  
    'DataProp' - A cell array of AstroImage data  
    properties on which the operator will operated.  
    Default is  
    {'ImageData','BackData','VarData','MaskData'}.  
    'DataPropIn' - Data property in the ImageComponent  
    on which the operator  
    will be operated. Default is 'Data'.  
    Output : - An array in which each element corresponds to the operator applied  
    to an element in the ImageComponent object.  
    If operator returns empty, then this function will  
    return NaN.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI = AstroImage({randn(100,100), randn(100,100)},'Back',{randn(100,100), randn(100,100)});  
    [A,B] = funUnaryScalar(AI, @mean, 'OpArgs',{'all'})  
    [A,B] = funUnaryScalar(AI, @std, 'OpArgs',{[],'all'})  
      


### funWCS

Apply function of WCS properties in AstroImage array


    
    Apply function of WCS properties in AstroImage array  


### get.Back

getter for BackImage


    
    getter for BackImage  


### get.Header

getter for Header


    
    getter for Header  


### get.Image

getter for Image - get image from ImageData property


    
    getter for Image - get image from ImageData property  


### get.Key

getter for Header keys


    
    getter for Header keys  


### get.Mask

getter for MaskImage


    
    getter for MaskImage  


### get.Var

getter for VarImage


    
    getter for VarImage  


### get.WCS

getter for WCS if empty, attempt to create from header


    
    getter for WCS  
    if empty, attempt to create from header  
      


### getStructKey

Get multiple  keys from headers in multiple AstroImage and store in a structure array The keyword search can be exact (UseDict=false), or using a keywords dictionary (UseDict=true).


    
    Get multiple  keys from headers in multiple AstroImage and store in a structure array  
    The keyword search can be exact (UseDict=false), or  
    using a keywords dictionary (UseDict=true).  
    Input  : - An AstroImage object (multiple elements supported)  
    - A cell array of keyword names. These are exact  
    keyword names without a dictionary interpretation.  
    * ...,key,val,...  
    'UseDict' - Indicating if to use dictionary or to  
    perform an exact search. Default is true.  
    'CaseSens' - Default is true.  
    'SearchAlgo' - ['strcmp'] | 'regexp'.  
    or 'last' match.  
    'Fill' - Fill value for the keyword Val, in case that the  
    key is not found. Default is NaN (comment will be  
    '').  
    'Val2Num' - Attempt to convert the value to numeric.  
    Default is true.  
    'IsInputAlt' - If true, then the input keyword  
    will be assumed to be in the list of  
    alternate names. If false, then this must  
    be the primary key name in the dictionary.  
    For example, if you would like to search  
    by 'AEXPTIME' use true.  
    Default is false.  
    'KeyDict' - An optional keyword dictionary (a s  
    tructure) that will override the object  
    dictionary.  
    Output : - A structure array, where number of elements equal  
    to the number of elements in the AstroImage.  
    For each requested keyword name there is a  
    corresponding field name, which value is the  
    keyword value.  
    Author: Eran Ofek  (Jun 2021)  
    Example: Im = ones(500,500);  
    AI = AstroImage({poissrnd(Im.*1e3), poissrnd(Im*3e3), poissrnd(Im.*1e4), poissrnd(Im.*1e4), poissrnd(Im.*2e4)});  
    AI(1).HeaderData.insertKey({'EXPTIME',1}); AI(2).HeaderData.insertKey({'EXPTIME',3}); AI(3).HeaderData.insertKey({'EXPTIME',10});  
    AI(4).HeaderData.insertKey({'EXPTIME',10}); AI(5).HeaderData.insertKey({'EXPTIME',20});  
    [Result] = getStructKey(AI, {'EXPTIME'})  
      
      


### imageIO2AstroImage

Convert an ImageIO object into an AstroImage object


    
    Convert an ImageIO object into an AstroImage object  
    Input  : - An ImageIO object.  
    - data property in which to store the image.  
    - Scale of the image.  
    - A logical indicating if to copy the header.  
    - An AstroImage object in which to put the data.  
    If empty, create a new object. Default is empty.  
    Output : - An AstroImage object.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI=AstroImage.imageIO2AstroImage(ImIO, 'ImageData', [], true)  
      


### isImType

Check if header IMTYPE keyword value equal some type


    
    Check if header IMTYPE keyword value equal some type  
    Input  : - An AstroImage object.  
    - IMTYPE type to check (e.g., 'bias').  
    * ...,key,val,...  
    'UseDict' - Indicating if to use dictionary or to  
    perform an exact search. Default is true.  
    'CaseSens' - Default is true.  
    'SearchAlgo' - ['strcmp'] | 'regexp'.  
    or 'last' match.  
    'IsInputAlt' - If true, then the input keyword  
    will be assumed to be in the list of  
    alternate names. If false, then this must  
    be the primary key name in the dictionary.  
    For example, if you would like to search  
    by 'AEXPTIME' use true.  
    Default is false.  
    'KeyDict' - An optional keyword dictionary (a s  
    tructure) that will override the object  
    dictionary.  
    Output : - An array of logicals (one per AstroImage element)  
    indicating if the IMTYPE value equal the requested  
    value.  
    Author : Eran Ofek (Apr 2021)  
    Example: H=AstroImage('*.fits');  
    Ans = isImType(H, 'bias')  
      


### isemptyImage

Check if data images in AstroImage object are empty


    
    Check if data images in AstroImage object are empty  
    Input  : - An AstroImage object (multi elements supported).  
    - A cell array of data properties for which to check  
    if empty.  
    Default is {'Image','Back','Var','Mask'}.  
    Output : * One output per requested data property. For each  
    data property, this is an array of logical  
    indicating if the data isempty.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI=AstroImage;  
    [a,b]=AI.isemptyImage({'Image','Back'})  
      


### julday

Return the Julian day for AstroImage object


    
    Return the Julian day for AstroImage object  
    Input  : - An AstroImage object  
    * Arbitrary number of arguments to pass to the  
    AstroHeader/juday function.  
    Output : - An array of JD (one per AstroImage element).  
    - An array of ExpTime.  
    Author : Eran Ofek  
    Example: AI=AstroImage('*.fits');  
    [JD,ET] = julday(AI(2:3));  
      


### maskSet

Set the value of a bit in a bit mask (Maskdata) in AstroImage


    
    Set the value of a bit in a bit mask (Maskdata) in AstroImage  
    Input  : - An AsstroImage Object.  
    - A matrix of logicals, with the same size as the  
    Image in the MaskData.Image, in which values which are  
    true will be set.  
    Alternatively, this can be a vector of indices.  
    - Bit name, or bit index (start from 0), to set.  
    - Value to set (0 | 1). Default is 1.  
    * ...,key,val,...  
    'CreateNewObj' - Indicating if the output  
    is a new copy of the input (true), or an  
    handle of the input (false).  
    If empty (default), then this argument will  
    be set by the number of output args.  
    If 0, then false, otherwise true.  
    This means that IC.fun, will modify IC,  
    while IB=IC.fun will generate a new copy in  
    IB.  
    Output : - An AstroImage object.  
    Author : Eran Ofek (May 2021)  
    Example: AI = AstroImage({rand(3,3)},'Mask',{uint32(zeros(3,3))})  
    AI.MaskData.Dict=BitDictionary('BitMask.Image.Default')  
    Flag = false(3,3); Flag(1,2)=true;  
    Result = AI.maskSet(Flag,'Saturated')  
    Result = AI.maskSet(Flag,'Streak')  
      


### minus

Apply the minus operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI - AI


    
    Apply the minus operator between AstroImage objects.  
    This function utilize the funBinary method.  
    See funBinary for details and additional arguments.  
    Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)});  
    R = AI - AI  
    R = AI - 1  
    AI = AstroImage({ones(10,10), 2.*ones(10,10)});  
    R = AI - AI(1)  
      


### object2array

Convert an AstroImage object that contains scalars into an array


    
    Convert an AstroImage object that contains scalars into an array  
    Input  : - An AstroImage object.  
    - A cell array of data properties to collect. Each  
    property must contains a scalar.  
    Default is {'Image'}.  
    Output : * Number of output arguments equal to the number of  
    data properties.  
    Each output argument is an array which size is  
    equal to size(Obj), and contains all the scalars  
    in the corresponding data property.  
    Author : - Eran Ofek (Apr 2021)  
    Example:  
      


### perfTest

perfTest for the AstroImage class


    
    perfTest for the AstroImage class  


### perfTestMat

Low level perfTest for the Matlab matrix


    
    Low level perfTest for the Matlab matrix  


### plus

Apply the plus operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI + AI


    
    Apply the plus operator between AstroImage objects.  
    This function utilize the funBinary method.  
    See funBinary for details and additional arguments.  
    Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)});  
    R = AI + AI  
    R = AI + 1  
    AI = AstroImage({ones(10,10), 2.*ones(10,10)});  
    R = AI + AI(1)  
      


### prepOperand2

Prepare the 2nd operand for binary operation


    
    Prepare the 2nd operand for binary operation  
      
    make sure Obj2 is in the right format  


### propagateWCS

Given An AstroImage with WCS property, propagate it to the header and catalog


    
    Given An AstroImage with WCS property, propagate it to the header and catalog  
    Input  : - An AstroImage object with populated WCS.  
    * ...,key,val,...  
    'OutCatCooUnits' - Units of RA/Dec added to catalog.  
    Default is 'deg'.  
    'OutCatColRA' - RA Column name added to catalog.  
    Default is 'RA'.  
    'OutCatColDec' - Dec Column name added to catalog.  
    Default is 'Dec'.  
    'OutCatColPos' - Position of RA/Dec columns added to catalog.  
    Default is Inf.  
    'OnlyIfSuccess' - Propagate WCS to header and  
    catalog only if WCS.Successtrue.  
    Default is true.  
    'UpdateCat' - Update catalog. Default is true.  
    'UpdateHead' - Update header. Default is true.  
    Output - An AstroImage object with the Catalog and Header  
    updated with the WCS information.  
    Author : Eran Ofek (Sep 2021)  
      


### rdivide

Apply the rdivide operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI ./ AI


    
    Apply the rdivide operator between AstroImage objects.  
    This function utilize the funBinary method.  
    See funBinary for details and additional arguments.  
    Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)});  
    R = AI ./ AI  
    R = AI ./ 2  
    AI = AstroImage({ones(10,10), 2.*ones(10,10)});  
    R = AI ./ AI(1)  
      


### readImages2AstroImage

Create AstroImage object and read images into a specific property.


    
    Create AstroImage object and read images into a specific property.  
    Input  : - Either:  
    [] - will return a single element empty object.  
    [N, M,...] - will return an empty objects  
    which size is [N, M,...].  
    A table to put in the Data property.  
    A cell array of matrices to put in the Data  
    property.  
    FileName with or without wild cards or regexp,  
    or a cell of file names to read.  
    * ...,key,val,...  
    'Obj' - An AstroImage object in which to put the  
    data in. If empty create a new object.  
    Default is empty.  
    'HDU' - HDU number or Dataset name from which to  
    read the images.  
    'FileType' - See ImageIO. Default is [].  
    'UseRegExp' - See ImageIO. Default is false.  
    'Scale' - The scale of the image (see definition  
    in ImageComponent). Default is [].  
    'DataProp' - AstroImage data property in wjich to  
    store the data. Default is 'ImageData'.  
    'ReadHeader' - Default is true.  
    Outout : - An AstroImage object with the images stored in the  
    requested field.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI=AstroImage.readImages2AstroImage('*.fits', 'DataProp', 'ImageData');  
    AI=AstroImage.readImages2AstroImage([]);  
    AI=AstroImage.readImages2AstroImage([1 2]);  
    AI=AstroImage.readImages2AstroImage({rand(10,10), rand(5,5)});  
    AI=AstroImage.readImages2AstroImage({rand(10,10), rand(5,5)},'DataProp','VarData');  
    AI=AstroImage.readImages2AstroImage({rand(10,10), rand(20,20)},'DataProp','ImageData');  
    AI=AstroImage.readImages2AstroImage({rand(10,10), rand(20,20)},'DataProp','BackData','Obj',AI);  
    AI=AstroImage.readImages2AstroImage({rand(5,5), rand(10,10)},'DataProp','VarData','Obj',AI,'Scale',2);  
      
      


### set.Back

setter for BackImage


    
    setter for BackImage  


### set.Image

setter for Image - store image in ImageData property Obj.(Relations.Image).Image = Data;   can use this instead


    
    setter for Image - store image in ImageData property  
    Obj.(Relations.Image).Image = Data;   can use this instead  


### set.Mask

setter for MaskImage


    
    setter for MaskImage  


### set.Var

setter for VarImage


    
    setter for VarImage  


### setKeyVal

Replace/insert keyword/value to HeaderData in AstroImage


    
    Replace/insert keyword/value to HeaderData in AstroImage  
    Input  : - An AstroImage object  
    - A key name or a cell array of key names.  
    - A cell array of values, corresponding to the key  
    names. Alternatively, a vector of numbers corresponding to the  
    key names.  
    * ...,key,val,...  
    see AstroHeader/replaceVal for options.  
    Output : - The input AstroImage with the updated header (this  
    is a pointer to the original input).  
    Author : Eran Ofek (Jul 2021)  
    Example: AI = AstroImage({rand(10,10)});  
    AI.setKeyVal('TYPE','science');  
      


### sizeImage

Return the size of images in AstroImage object


    
    Return the size of images in AstroImage object  
    Input  : - An AstroImage object (multi elements supported).  
    - A single propery name (char array)  
    Output : - Number of rows in each AstroImage element.  
    - Number of columns in each AstroImage element.  
    Author : Eran Ofek (Apr 2021)  
    Example: AI=AstroImage;  
    [Ny, Nx] = AI.sizeImage  
    [Ny, Nx] = AI.sizeImage('Back')  
      


### times

Apply the times operator between AstroImage objects. This function utilize the funBinary method. See funBinary for details and additional arguments. Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)}); R = AI .* AI


    
    Apply the times operator between AstroImage objects.  
    This function utilize the funBinary method.  
    See funBinary for details and additional arguments.  
    Example: AI = AstroImage({ones(10,10), 2.*ones(20,20)});  
    R = AI .* AI  
    R = AI .* 1  
    AI = AstroImage({ones(10,10), 2.*ones(10,10)});  
    R = AI .* AI(1)  
      


### unitTest

unitTest for AstroImage Example: AstroImage.unitTest


    
    unitTest for AstroImage  
    Example: AstroImage.unitTest  
      


