# Class: AstroPSF



    
    AstroPSF - A container class for PSFs  
    Properties :  
    Data - A dependent property that generates the PSF stamp  
    Var -  A dependent property that generates the PSF variance stamp  
    DataPSF - A PSF data. Stamp, or function parameters  
    DataVar - A PSF variance data. Stamp, or function parameters  
    FunPSF - A PSF function handle  
    ArgVals - Arguments values.  
    ArgNames - The argument names.  
    StampSize - PSF stamp size.  
    Functionality :  
      
      
    TODO:  
    1. resampling and scaling of PSF  
    In some cases we may want to generate the PSF in oversampling  
    2. Info about sub pixel response?  
    3. Info about how the PSF was generated  
      
### AstroPSF




    
      
      
### curve_of_growth

Calculate curve of growth of a PSF includinf radii


    
    Calculate curve of growth of a PSF includinf radii  
    Input  : - An AstroPSF object  
    * ...,key,val,...  
    'ReCenter' - A logical indicating if to find the  
    PSF center using the first moment (true),  
    or to use the stamp center (false).  
    Default is true.  
    'CenterPSFxy' - PSF center [x,y] coordinates. If [], or not provided, default  
    is half the PSF matrix size.  
    'Step' - Step size of curve of growth. Default is 1.  
    'Level' - Level at which to calculate radius.  
    Default is 0.5.  
    'InterpMethod' - Interpolation method.  
    Default is 'linear';  
    'EpsStep' - Default is 1e-8.  
    Output : - A structure with the radiao profile, including the following  
    fields:  
    .Radius - radius  
    .Sum    -sum  
    .Npix   - number of pixels in annulus  
    .Mean   - mean  
    .Med    - median  
    .CumSum - cumulative sum.  
    - Column vector of RadHalfCumSum, radius of cumsum=level  
    - Column vector of RadHalfPeak, radius of flux=level.  
    Example: AP = AstroPSF;  
    AP.DataPSF = imUtil.kernel2.gauss;  
    [Result, RadHalfCumSum, RadHalfPeak] = curve_of_growth(AP);  
      
### funUnary




    
      
      
### fwhm

Calculate the FWHM of a PSF using the curve of growth (for alternative method use moment2).


    
    Calculate the FWHM of a PSF using the curve of growth  
    (for alternative method use moment2).  
    Input  : - An AstroPSF object.  
    * ...,key,vall,...  
    'curvePars' - A cell array of key,val arguments to  
    pass to curve_of_growth. Default is {}.  
    Output : - The FWHM calculated from the half cumsum.  
    - The FWHM calculated from the half peak flux  
    radius.  
    Author : Eran Ofek (May 2021)  
    Example: [FWHM_CumSum, FWHM_Flux] = fwhm(AP);  
      
      
### get.Data

getter for Dependent property Data


    
    getter for Dependent property Data  
### get.Var

getter for Dependent property Var


    
    getter for Dependent property Var  
### getPSF

get PSF from AstroPSF object


    
    get PSF from AstroPSF object  
    Input : - A single AstroPSF object.  
    - DataPSF is empty, will take Obj.DataPSF.  
    If not empty, will also populate Obj.DataPSF.  
    Default is empty.  
    - FunPSF function handle (like DataPSF). Default is [].  
    - StampSize [I,J]. If empty, use default.  
    Default is [].  
    - ArgVals (like DataPSF). Default is [].  
    - ArgNames (like DataPSF). Default is [].  
    Output : - A PSF stamp.  
    Author : Eran Ofek  
    Example:  
      
### images2cube

Transform an array of AstroPSF into a cube of PSFs


    
    Transform an array of AstroPSF into a cube of PSFs  
    Input  : - An AstroPSF object.  
    The Data size in all the elements must be the  
    same.  
    Output : - A cube of PSF, where the PSF index is in the 3rd  
    dimension.  
    - A cube of PSF variances, where the PSF index is in the 3rd  
    dimension.  
    Author : Eran Ofek  
    Example: [CubeData, CubeVar] = images2cube(Obj)  
      
### moment2

Calculate the moments and perture photometry of PSFs using the imUtil.image.moment2 function.


    
    Calculate the moments and perture photometry of PSFs  
    using the imUtil.image.moment2 function.  
    Input  : - An AstroPSF object in which all the PSFs have the  
    same size.  
    * Pairs of ...,key,val,... The following keywords are available:  
    'AperRadius' - Vector of aperture radii, in which to calculate  
    aperture photometry.  
    Default is [2 4 6].  
    'Annulus' - Vector of inner and outer radius of background  
    annulus. Default is [8 12].  
    'BackFun' - Function handle to use for background estimation.  
    In order to meaningful this function must ignore  
    NaNs.  
    Default is @nanmedian.  
    'MomRadius' - Radius around position in which to calculate the  
    moments. Recomended ~1.7 FWHM. Default is 8.  
    'WeightFun' - The weight function to use for weighting the  
    moments and the weighted photometry.  
    This can be a scalar indicating the sigma of a  
    circularly symmetric Gaussian,  
    or a function handle that matrix of radii, and  
    return a matrix of weights (e.g., @(r)  
    exp(-r.^2./(2.*4))./(2.*pi.*4.^2); ).  
    Default is 2.  
    'Circle' - A flag indicating if to extract the stamps with  
    circular shape. Default is false.  
    'MaxIter' - Maximum number of 1st moment position iterations.  
    0 will perform aingle 1st moment calculation.  
    Default is 10.  
    'NoWeightFirstIter' - A flag indicating if not to apply weight  
    on the first itearation. Default is true.  
    'PosConvergence' - Position convergence. Default is 1e-4.  
    'DynamicWindow' - Apply dynamic windowing. Default is true.  
    'WindowOnlyOnLastIter' -Default is false.  
    'FinalIterWithCorrectWin' - Apply an additional final  
    iteration with the correct window.  
    'mexCutout' - use imUtil.image.mexCutout.m (true) or  
    imUtil.image.find_within_radius_mat (false).  
    Default is true.  
    Output  : - First moment information.  
    A structure with the following fields.  
    .RoundX - Vector of roundex X position  
    .RoundY - Vector of roundex Y position  
    .DeltaLastX - Vector of the X shifts in the last position  
    iteration.  
    .DeltaLastY - Vector of the Y shifts in the last position  
    iteration.  
    .Iter - Number of position iterations.  
    .X    - 1st moment X position  
    .Y    - 1st moment Y position.  
    .Xstart - Starting X position,  
    .Ystart - Starting Y position.  
    - A second momement information.  
    A structure with the following fields.  
    .X2 - X^2 2nd moment.  
    .Y2 - Y.^2 2nd moment.  
    .XY - X*Y 2nd moment.  
    - Photometry information. A structure with the following fields.  
    .AperRadius - Vector of apertures radius.  
    .AperPhot - Matrix of aperture photometry. Column per  
    aperture.  
    .AperArea - Matrix of apertures area. Column per aperture.  
    .BoxPhot  - Vector of the full box photometry  
    .AnnulusBack - Annulus background.  
    .AnnulusStd - Annulus StD.  
    .WeightedAper - Weighted photometry. Weighted by the user  
    specified weight function.  
    Example: AP = AstroPSF;  
    AP.DataPSF = imUtil.kernel2.gauss;  
    AP(2).DataPSF = imUtil.kernel2.gauss;  
    [M1,M2,Aper] = moment2(AP);  
      
### multiGaussianPSF

I = G1(x,y, sigmaX(X,Y,Color,Flux), sigmaY(X,Y,Color,Flux), rho(X,Y,Color,Flux) )


    
      
    I = G1(x,y, sigmaX(X,Y,Color,Flux), sigmaY(X,Y,Color,Flux), rho(X,Y,Color,Flux) )  
      
      
      
      
### set.Data

setter for Dependent property Data


    
    setter for Dependent property Data  
### set.Var

setter for Dependent property Var


    
    setter for Dependent property Var  
### unitTest

unitTest for AstroPSF Example: Result = AstroPSF.unitTest


    
    unitTest for AstroPSF  
    Example: Result = AstroPSF.unitTest  
      
